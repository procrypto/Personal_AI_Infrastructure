The file /Users/neilhart/Documents/BONKbot/github/web-terminal-frontend/feat-token-analysis-autopilot/apps/web-terminal/src/websocket/socketio/socketIOInstance.ts has been updated. Here's the result of running `cat -n` on a snippet of the edited file:
     1→import { PVP_API_URL, SENTINEL_SOCKET_IO_URL, IS_LOCAL_ENV } from "@/config";
     2→import { getDataAccessToken } from "@/utils/auth-tokens";
     3→import {
     4→  SocketIOManager,
     5→  type SocketIOManagerOptions,
     6→} from "./SocketIOManager";
     7→import { SocketIOWorkerClient } from "./worker/SocketIOWorkerClient";
     8→import { isSharedWorkerSupported } from "./worker/SocketIOWorkerManager";
     9→
    10→// Use shared worker if supported, otherwise fall back to direct connection
    11→const isBrowser = typeof window !== "undefined";
    12→const useSharedWorker = isBrowser && isSharedWorkerSupported();
    13→
    14→/**
    15→ * Create a new Socket.IO manager instance
    16→ * @param options.url - WebSocket URL (required, unless local env)
    17→ * @param options.getToken - Token getter function, called at connect time for fresh token
    18→ * @returns SocketIOManager or SocketIOWorkerClient depending on browser support, or null if URL not configured
    19→ *
    20→ * @example
    21→ * const manager = createSocketIOManager({
    22→ *   url: SOCKET_IO_URL,
    23→ *   getToken: () => getDataAccessToken() ?? undefined,
    24→ * });
    25→ */
    26→export function createSocketIOManager(
    27→  options: SocketIOManagerOptions
    28→): SocketIOManager | SocketIOWorkerClient | null {
    29→  // Skip creation if URL is not configured (local dev without SocketIO)
    30→  if (!options.url) {
    31→    if (IS_LOCAL_ENV) {
    32→      console.warn("[SocketIO] URL not configured, skipping initialization");
    33→    }
    34→    return null;
    35→  }
    36→  if (useSharedWorker) {
    37→    return new SocketIOWorkerClient(options);
    38→  }
    39→  return new SocketIOManager(options);
    40→}
    41→
    42→// Default singleton instance
    43→// Uses getToken to fetch fresh token at connect time (supports token refresh)
    44→export const socketIOManager: SocketIOManager | SocketIOWorkerClient | null =
    45→  createSocketIOManager({
    46→    url: SENTINEL_SOCKET_IO_URL,
    47→    getToken: () => getDataAccessToken() ?? undefined,
    48→  });
    49→
    50→export const socketIOManagerPvp: SocketIOManager | SocketIOWorkerClient | null =
    51→  createSocketIOManager({
    52→    url: PVP_API_URL,
    53→    getToken: () => getDataAccessToken() ?? undefined,
    54→  });
    55→
    56→if (import.meta.env.DEV) {
    57→  console.log(
    58→    `[SocketIO] Using ${useSharedWorker ? "SharedWorker" : "direct connection"} mode`