The file /Users/neilhart/Documents/BONKbot/github/web-terminal-frontend/feat-token-analysis-autopilot/apps/web-terminal/src/ui/dashboard/widgets/autopilot-widget.tsx has been updated. Here's the result of running `cat -n` on a snippet of the edited file:
     1â†’/* eslint-disable lingui/no-unlocalized-strings */
     2â†’import { useState } from "react";
     3â†’import { FormattedNumber } from "@/components/formatted-number/formatted-number";
     4â†’import { Bot, AlertTriangle, TrendingUp, TrendingDown, Activity, Zap, Target, ShieldAlert, Clock, Eye, Flame, Wallet, Settings, RefreshCw, Power, Layers, CheckCircle2, Circle } from "lucide-react";
     5â†’import { cn } from "@/lib/utils";
     6â†’import { Switch } from "@/components/switch";
     7â†’import { Tooltip } from "@/components/tooltip";
     8â†’import { useAutopilotSubscription } from "@/hooks/useSubscriptions/useAutopilotSubscription";
     9â†’import { useAutopilotData, type AutopilotPositionWithPnL } from "@/hooks/useAutopilot";
    10â†’import type {
    11â†’  AutopilotSignal,
    12â†’  AutopilotMarketStatus,
    13â†’  AutopilotStats,
    14â†’  AutopilotTokenList,
    15â†’  AutopilotConfig,
    16â†’  AutopilotStrategies,
    17â†’  WatchedToken,
    18â†’} from "@/store/memoryStore/slices/autopilot-store/types";
    19â†’import type { AutopilotCommand } from "@/websocket/autopilot/AutopilotWebsocket";
    20â†’
    21â†’// Market Status Badge Component
    22â†’const MarketStatusBadge = ({ status }: { status: AutopilotMarketStatus }) => {
    23â†’  const stateConfig = {
    24â†’    NORMAL: { color: "bg-green-500/20 text-green-400 border-green-500/30", icon: Activity, label: "NORMAL" },
    25â†’    CAUTION: { color: "bg-yellow-500/20 text-yellow-400 border-yellow-500/30", icon: AlertTriangle, label: "CAUTION" },
    26â†’    DUMP: { color: "bg-red-500/20 text-red-400 border-red-500/30", icon: ShieldAlert, label: "DUMP" },
    27â†’  };
    28â†’
    29â†’  const config = stateConfig[status.state];
    30â†’  const Icon = config.icon;
    31â†’
    32â†’  return (
    33â†’    <div className={cn("flex items-center gap-2 rounded-lg border px-3 py-1.5", config.color)}>
    34â†’      <Icon className="h-4 w-4" />
    35â†’      <span className="text-xs font-semibold">{config.label}</span>
    36â†’      <span className="text-xs opacity-75">
    37â†’        SOL {status.solPriceChangePercent >= 0 ? "+" : ""}
    38â†’        {status.solPriceChangePercent.toFixed(2)}%
    39â†’      </span>
    40â†’    </div>
    41â†’  );
    42â†’};
    43â†’
    44â†’// Position Card Component - handles nullable P&L from NATS market data
    45â†’const PositionCard = ({ position }: { position: AutopilotPositionWithPnL }) => {
    46â†’  const isProfit = (position.pnlPercent ?? 0) >= 0;
    47â†’  const holdTime = Math.floor((Date.now() - position.entryTime) / 60000); // minutes
    48â†’  const hasMarketData = position.pnlPercent !== null;
    49â†’
    50â†’  return (
    51â†’    <div className="border-border-primary bg-bg-tertiary/50 flex items-center justify-between rounded-lg border p-3">
    52â†’      <div className="flex items-center gap-3">
    53â†’        <div
    54â†’          className={cn(
    55â†’            "flex h-8 w-8 items-center justify-center rounded-lg text-xs font-bold",
    56â†’            hasMarketData
    57â†’              ? isProfit ? "bg-green-500/20 text-green-400" : "bg-red-500/20 text-red-400"
    58â†’              : "bg-gray-500/20 text-gray-400"
    59â†’          )}
    60â†’        >
    61â†’          {hasMarketData ? (
    62â†’            isProfit ? <TrendingUp className="h-4 w-4" /> : <TrendingDown className="h-4 w-4" />
    63â†’          ) : (
    64â†’            <Activity className="h-4 w-4 animate-pulse" />
    65â†’          )}
    66â†’        </div>
    67â†’        <div>
    68â†’          <span className="text-text-primary text-sm font-medium">${position.symbol}</span>
    69â†’          <div className="text-text-secondary flex items-center gap-1 text-[10px]">
    70â†’            <Clock className="h-3 w-3" />
    71â†’            {holdTime}m
    72â†’          </div>
    73â†’        </div>
    74â†’      </div>
    75â†’      <div className="text-right">
    76â†’        {hasMarketData ? (
    77â†’          <>
    78â†’            <div className={cn("text-sm font-semibold", isProfit ? "text-green-400" : "text-red-400")}>
    79â†’              {isProfit ? "+" : ""}
    80â†’              {position.pnlPercent!.toFixed(2)}%
    81â†’            </div>
    82â†’            <div className="text-text-secondary text-[10px]">
    83â†’              {position.positionSizeSol.toFixed(2)} SOL
    84â†’            </div>
    85â†’          </>
    86â†’        ) : (
    87â†’          <>
    88â†’            <div className="text-sm font-semibold text-text-tertiary animate-pulse">
    89â†’              Loading...
    90â†’            </div>
    91â†’            <div className="text-text-secondary text-[10px]">
    92â†’              {position.positionSizeSol.toFixed(2)} SOL
    93â†’            </div>
    94â†’          </>
    95â†’        )}
    96â†’      </div>
    97â†’    </div>
    98â†’  );
    99â†’};
   100â†’
   101â†’// Signal Item Component
   102â†’const SignalItem = ({ signal }: { signal: AutopilotSignal }) => {
   103â†’  const signalConfig = {
   104â†’    magic_buy: { color: "text-cyan-400", icon: Target, label: "BUY" },
   105â†’    magic_exit: { color: "text-purple-400", icon: Zap, label: "EXIT" },
   106â†’    dump_exit: { color: "text-red-400", icon: ShieldAlert, label: "DUMP" },
   107â†’    rule_signal: { color: "text-blue-400", icon: Activity, label: "SIGNAL" },
   108â†’  };
   109â†’
   110â†’  const config = signalConfig[signal.signalType];
   111â†’  const Icon = config.icon;
   112â†’  const time = new Date(signal.timestamp).toLocaleTimeString("en-US", { hour12: false, hour: "2-digit", minute: "2-digit", second: "2-digit" });
   113â†’
   114â†’  return (
   115â†’    <div className="border-border-primary/50 flex items-center gap-2 border-b py-2 last:border-0">
   116â†’      <Icon className={cn("h-3.5 w-3.5", config.color)} />
   117â†’      <span className="text-text-secondary text-[10px]">{time}</span>
   118â†’      <span className={cn("text-xs font-medium", config.color)}>{config.label}</span>
   119â†’      <span className="text-text-primary text-xs">${signal.symbol}</span>
   120â†’      {signal.pnlPercent !== undefined && (
   121â†’        <span className={cn("text-xs", signal.pnlPercent >= 0 ? "text-green-400" : "text-red-400")}>
   122â†’          {signal.pnlPercent >= 0 ? "+" : ""}
   123â†’          {signal.pnlPercent.toFixed(1)}%
   124â†’        </span>
   125â†’      )}
   126â†’    </div>
   127â†’  );
   128â†’};
   129â†’
   130â†’// Token Row Component
   131â†’const TokenRow = ({ token }: { token: WatchedToken }) => {
   132â†’  const change = token.change1h ?? 0;
   133â†’  const isPositive = change >= 0;
   134â†’
   135â†’  return (
   136â†’    <div className={cn(
   137â†’      "flex items-center justify-between rounded px-2 py-1.5 text-xs",
   138â†’      token.hasPosition ? "bg-cyan-500/10 border border-cyan-500/20" : "bg-bg-tertiary/30"
   139â†’    )}>
   140â†’      <div className="flex items-center gap-2">
   141â†’        <span className="text-text-primary font-medium">${token.symbol}</span>
   142â†’        {token.hasPosition && (
   143â†’          <span className="text-[8px] text-cyan-400 font-semibold">OPEN</span>
   144â†’        )}
   145â†’      </div>
   146â†’      <div className="flex items-center gap-3">
   147â†’        {token.priceUsd !== undefined && (
   148â†’          <span className="text-text-secondary">
   149â†’            ${token.priceUsd < 0.01 ? token.priceUsd.toExponential(2) : token.priceUsd.toFixed(4)}
   150â†’          </span>
   151â†’        )}
   152â†’        <span className={cn("font-medium", isPositive ? "text-green-400" : "text-red-400")}>
   153â†’          {isPositive ? "+" : ""}{change.toFixed(1)}%
   154â†’        </span>
   155â†’      </div>
   156â†’    </div>
   157â†’  );
   158â†’};
   159â†’
   160â†’// Token List Section Component
   161â†’const TokenListSection = ({
   162â†’  title,
   163â†’  icon: Icon,
   164â†’  tokens,
   165â†’  iconColor
   166â†’}: {
   167â†’  title: string;
   168â†’  icon: React.ElementType;
   169â†’  tokens: WatchedToken[];
   170â†’  iconColor: string;
   171â†’}) => {
   172â†’  if (tokens.length === 0) return null;
   173â†’
   174â†’  return (
   175â†’    <div className="flex-shrink-0">
   176â†’      <div className="text-text-secondary mb-1.5 flex items-center gap-2 text-xs font-medium">
   177â†’        <Icon className={cn("h-3.5 w-3.5", iconColor)} />
   178â†’        {title} ({tokens.length})
   179â†’      </div>
   180â†’      <div className="max-h-32 space-y-1 overflow-auto">
   181â†’        {tokens.map((token) => (
   182â†’          <TokenRow key={token.mint} token={token} />
   183â†’        ))}
   184â†’      </div>
   185â†’    </div>
   186â†’  );
   187â†’};
   188â†’
   189â†’// Controls Panel Component
   190â†’const ControlsPanel = ({
   191â†’  config,
   192â†’  sendCommand,
   193â†’  isConnected,
   194â†’}: {
   195â†’  config: AutopilotConfig;
   196â†’  sendCommand: (cmd: AutopilotCommand) => void;
   197â†’  isConnected: boolean;
   198â†’}) => {
   199â†’  const [showControls, setShowControls] = useState(false);
   200â†’
   201â†’  return (
   202â†’    <div className="border-border-primary bg-bg-tertiary/30 rounded-lg border">
   203â†’      {/* Header - always visible */}
   204â†’      <button
   205â†’        onClick={() => setShowControls(!showControls)}
   206â†’        className="flex w-full items-center justify-between px-3 py-2 text-xs"
   207â†’        disabled={!isConnected}
   208â†’      >
   209â†’        <div className="flex items-center gap-2">
   210â†’          <Settings className="h-3.5 w-3.5 text-text-secondary" />
   211â†’          <span className="text-text-secondary font-medium">Controls</span>
   212â†’        </div>
   213â†’        <div className="flex items-center gap-2">
   214â†’          <span className={cn(
   215â†’            "rounded px-1.5 py-0.5 text-[10px] font-semibold",
   216â†’            config.mode === "paper" ? "bg-yellow-500/20 text-yellow-400" : "bg-green-500/20 text-green-400"
   217â†’          )}>
   218â†’            {config.mode.toUpperCase()}
   219â†’          </span>
   220â†’          <span className="text-text-tertiary">{showControls ? "â–²" : "â–¼"}</span>
   221â†’        </div>
   222â†’      </button>
   223â†’
   224â†’      {/* Expandable controls */}
   225â†’      {showControls && (
   226â†’        <div className="border-t border-border-primary/50 px-3 py-2 space-y-3">
   227â†’          {/* Mode Toggle - Disabled until LOIS integration */}
   228â†’          <Tooltip
   229â†’            content="Live trading integration coming soon. Invite only ðŸ”’"
   230â†’            side="left"
   231â†’            triggerClassName="w-full"
   232â†’          >
   233â†’            <div className="flex w-full items-center justify-between opacity-50 cursor-not-allowed">
   234â†’              <div className="flex items-center gap-2">
   235â†’                <Power className="h-3.5 w-3.5 text-text-secondary" />
   236â†’                <span className="text-xs text-text-secondary">Live Trading</span>
   237â†’              </div>
   238â†’              <Switch
   239â†’                size="sm"
   240â†’                checked={false}
   241â†’                disabled
   242â†’              />
   243â†’            </div>
   244â†’          </Tooltip>
   245â†’
   246â†’          {/* Auto Sources Toggle */}
   247â†’          <div className="flex items-center justify-between">
   248â†’            <div className="flex items-center gap-2">
   249â†’              <Eye className="h-3.5 w-3.5 text-blue-400" />
   250â†’              <span className="text-xs text-text-secondary">Auto Sources</span>
   251â†’            </div>
   252â†’            <Switch
   253â†’              size="sm"
   254â†’              checked={config.autoSourcesEnabled}
   255â†’              onCheckedChange={(checked) => sendCommand({ command: "toggle_sources", enabled: checked })}
   256â†’            />
   257â†’          </div>
   258â†’
   259â†’          {/* Trending Toggle */}
   260â†’          {config.autoSourcesEnabled && (
   261â†’            <div className="flex items-center justify-between pl-5">
   262â†’              <div className="flex items-center gap-2">
   263â†’                <Flame className="h-3 w-3 text-orange-400" />
   264â†’                <span className="text-[11px] text-text-tertiary">Trending</span>
   265â†’              </div>
   266â†’              <Switch
   267â†’                size="sm"
   268â†’                checked={config.trendingEnabled}
   269â†’                onCheckedChange={(checked) => sendCommand({ command: "toggle_trending", enabled: checked })}
   270â†’              />
   271â†’            </div>
   272â†’          )}
   273â†’
   274â†’          {/* Whales Toggle */}
   275â†’          {config.autoSourcesEnabled && (
   276â†’            <div className="flex items-center justify-between pl-5">
   277â†’              <div className="flex items-center gap-2">
   278â†’                <Wallet className="h-3 w-3 text-green-400" />
   279â†’                <span className="text-[11px] text-text-tertiary">Whale Moves</span>
   280â†’              </div>
   281â†’              <Switch
   282â†’                size="sm"
   283â†’                checked={config.whalesEnabled}
   284â†’                onCheckedChange={(checked) => sendCommand({ command: "toggle_whales", enabled: checked })}
   285â†’              />
   286â†’            </div>
   287â†’          )}
   288â†’
   289â†’          {/* Market Filter Toggle */}
   290â†’          <div className="flex items-center justify-between">
   291â†’            <div className="flex items-center gap-2">
   292â†’              <ShieldAlert className="h-3.5 w-3.5 text-purple-400" />
   293â†’              <span className="text-xs text-text-secondary">Market Filter</span>
   294â†’            </div>
   295â†’            <Switch
   296â†’              size="sm"
   297â†’              checked={config.marketFilterEnabled}
   298â†’              onCheckedChange={(checked) => sendCommand({ command: "toggle_filter", enabled: checked })}
   299â†’            />
   300â†’          </div>
   301â†’
   302â†’          {/* Refresh Sources Button */}
   303â†’          <button
   304â†’            onClick={() => sendCommand({ command: "refresh_sources" })}
   305â†’            className="flex w-full items-center justify-center gap-2 rounded bg-bg-tertiary/50 px-3 py-1.5 text-xs text-text-secondary hover:bg-bg-tertiary transition-colors"
   306â†’          >
   307â†’            <RefreshCw className="h-3 w-3" />
   308â†’            Refresh Sources
   309â†’          </button>
   310â†’
   311â†’          {/* Position Size Display */}
   312â†’          <div className="flex items-center justify-between text-[10px] text-text-tertiary pt-1 border-t border-border-primary/30">
   313â†’            <span>Position Size</span>
   314â†’            <span>{config.positionSizeSol} SOL</span>
   315â†’          </div>
   316â†’        </div>
   317â†’      )}
   318â†’    </div>
   319â†’  );
   320â†’};
   321â†’
   322â†’// Strategies Panel Component
   323â†’const StrategiesPanel = ({
   324â†’  strategies,
   325â†’  sendCommand,
   326â†’  isConnected,
   327â†’}: {
   328â†’  strategies: AutopilotStrategies;
   329â†’  sendCommand: (cmd: AutopilotCommand) => void;
   330â†’  isConnected: boolean;
   331â†’}) => {
   332â†’  const [showStrategies, setShowStrategies] = useState(false);
   333â†’  const activeSet = new Set(strategies.active);
   334â†’
   335â†’  return (
   336â†’    <div className="border-border-primary bg-bg-tertiary/30 rounded-lg border">
   337â†’      {/* Header - always visible */}
   338â†’      <button
   339â†’        onClick={() => setShowStrategies(!showStrategies)}
   340â†’        className="flex w-full items-center justify-between px-3 py-2 text-xs"
   341â†’        disabled={!isConnected}
   342â†’      >
   343â†’        <div className="flex items-center gap-2">
   344â†’          <Layers className="h-3.5 w-3.5 text-text-secondary" />
   345â†’          <span className="text-text-secondary font-medium">Strategies</span>
   346â†’        </div>
   347â†’        <div className="flex items-center gap-2">
   348â†’          <span className={cn(
   349â†’            "rounded px-1.5 py-0.5 text-[10px] font-semibold",
   350â†’            strategies.active.length > 0 ? "bg-green-500/20 text-green-400" : "bg-gray-500/20 text-gray-400"
   351â†’          )}>
   352â†’            {strategies.active.length} ACTIVE
   353â†’          </span>
   354â†’          <span className="text-text-tertiary">{showStrategies ? "â–²" : "â–¼"}</span>
   355â†’        </div>
   356â†’      </button>
   357â†’
   358â†’      {/* Expandable strategies list */}
   359â†’      {showStrategies && (
   360â†’        <div className="border-t border-border-primary/50 px-3 py-2 space-y-2">
   361â†’          {strategies.available.length === 0 ? (
   362â†’            <div className="text-text-tertiary text-xs text-center py-2">
   363â†’              No strategies available
   364â†’            </div>
   365â†’          ) : (
   366â†’            strategies.available.map((strategy) => {
   367â†’              const isActive = activeSet.has(strategy.id);
   368â†’              return (
   369â†’                <button
   370â†’                  key={strategy.id}
   371â†’                  onClick={() => sendCommand({ command: "toggle_strategy", strategyId: strategy.id, enabled: !isActive })}
   372â†’                  className={cn(
   373â†’                    "w-full flex items-start gap-2 rounded px-2 py-2 text-left transition-colors",
   374â†’                    isActive
   375â†’                      ? "bg-green-500/10 border border-green-500/30 hover:bg-green-500/20"
   376â†’                      : "bg-bg-tertiary/50 border border-transparent hover:bg-bg-tertiary"
   377â†’                  )}
   378â†’                >
   379â†’                  <div className="flex-shrink-0 mt-0.5">
   380â†’                    {isActive ? (
   381â†’                      <CheckCircle2 className="h-4 w-4 text-green-400" />
   382â†’                    ) : (
   383â†’                      <Circle className="h-4 w-4 text-text-tertiary" />
   384â†’                    )}
   385â†’                  </div>
   386â†’                  <div className="flex-1 min-w-0">
   387â†’                    <div className="flex items-center gap-2">
   388â†’                      <span className={cn(
   389â†’                        "text-xs font-medium",
   390â†’                        isActive ? "text-green-400" : "text-text-primary"
   391â†’                      )}>
   392â†’                        {strategy.name}
   393â†’                      </span>
   394â†’                      <span className={cn(
   395â†’                        "text-[9px] px-1 py-0.5 rounded",
   396â†’                        strategy.mode === "all"
   397â†’                          ? "bg-blue-500/20 text-blue-400"
   398â†’                          : "bg-purple-500/20 text-purple-400"
   399â†’                      )}>
   400â†’                        {strategy.mode.toUpperCase()}
   401â†’                      </span>
   402â†’                    </div>
   403â†’                    <div className="text-[10px] text-text-tertiary truncate">
   404â†’                      {strategy.summary}
   405â†’                    </div>
   406â†’                  </div>
   407â†’                </button>
   408â†’              );
   409â†’            })
   410â†’          )}
   411â†’        </div>
   412â†’      )}
   413â†’    </div>
   414â†’  );
   415â†’};
   416â†’
   417â†’// Stats Panel Component
   418â†’const StatsPanel = ({ stats }: { stats: AutopilotStats }) => {
   419â†’  const isProfit = stats.totalPnlSol >= 0;
   420â†’
   421â†’  return (
   422â†’    <div className="border-border-primary bg-bg-tertiary/30 grid grid-cols-4 gap-2 rounded-lg border p-3">
   423â†’      <div className="text-center">
   424â†’        <div className="text-text-primary text-lg font-bold">{stats.closedTrades}</div>
   425â†’        <div className="text-text-secondary text-[10px]">Trades</div>
   426â†’      </div>
   427â†’      <div className="text-center">
   428â†’        <div className={cn("text-lg font-bold", stats.winRate >= 0.5 ? "text-green-400" : "text-red-400")}>
   429â†’          {(stats.winRate * 100).toFixed(0)}%
   430â†’        </div>
   431â†’        <div className="text-text-secondary text-[10px]">Win Rate</div>
   432â†’      </div>
   433â†’      <div className="text-center">
   434â†’        <div className="text-text-primary text-lg font-bold">
   435â†’          {stats.wins}W/{stats.losses}L
   436â†’        </div>
   437â†’        <div className="text-text-secondary text-[10px]">Record</div>
   438â†’      </div>
   439â†’      <div className="text-center">
   440â†’        <div className={cn("text-lg font-bold", isProfit ? "text-green-400" : "text-red-400")}>
   441â†’          {isProfit ? "+" : ""}
   442â†’          <FormattedNumber value={stats.totalPnlSol} decimals={2} />
   443â†’        </div>
   444â†’        <div className="text-text-secondary text-[10px]">P&L (SOL)</div>
   445â†’      </div>
   446â†’    </div>
   447â†’  );
   448â†’};
   449â†’
   450â†’// Main Autopilot Widget Component
   451â†’export const AutopilotWidget = () => {
   452â†’  // Connect to autopilot backend and auto-subscribe to NATS market data
   453â†’  useAutopilotSubscription({ isEnabled: true });
   454â†’
   455â†’  // Get all autopilot data from Zustand store
   456â†’  const {
   457â†’    positions,
   458â†’    signals,
   459â†’    marketStatus,
   460â†’    stats,
   461â†’    scanTick,
   462â†’    tokenList,
   463â†’    config,
   464â†’    strategies,
   465â†’    isConnected,
   466â†’    sendCommand,
   467â†’  } = useAutopilotData();
   468â†’
   469â†’  const totalTokens = tokenList.watchlist.length + tokenList.trending.length + tokenList.whales.length;
   470â†’
   471â†’  return (
   472â†’    <div className="flex h-full flex-col gap-3 overflow-hidden">
   473â†’      {/* Header - Market Status */}
   474â†’      <div className="flex items-center justify-between">
   475â†’        <div className="flex items-center gap-2">
   476â†’          <Bot className={cn("h-5 w-5", isConnected ? "text-green-400" : "text-red-400")} />
   477â†’          <span className="text-text-primary text-sm font-semibold">Token Autopilot</span>
   478â†’          {scanTick && (
   479â†’            <span className="text-text-secondary text-[10px]">
   480â†’              #{scanTick.scanNumber} | {totalTokens} tokens
   481â†’            </span>
   482â†’          )}
   483â†’        </div>
   484â†’        <MarketStatusBadge status={marketStatus} />
   485â†’      </div>
   486â†’
   487â†’      {/* Connection Status (shown when disconnected) */}
   488â†’      {!isConnected && (
   489â†’        <div className="bg-yellow-500/10 border-yellow-500/30 flex items-center gap-2 rounded-lg border px-3 py-2">
   490â†’          <AlertTriangle className="h-4 w-4 text-yellow-400" />
   491â†’          <span className="text-xs text-yellow-400">Connecting to autopilot backend...</span>
   492â†’        </div>
   493â†’      )}
   494â†’
   495â†’      {/* Controls Panel */}
   496â†’      <ControlsPanel config={config} sendCommand={sendCommand} isConnected={isConnected} />
   497â†’
   498â†’      {/* Strategies Panel */}
   499â†’      <StrategiesPanel strategies={strategies} sendCommand={sendCommand} isConnected={isConnected} />
   500â†’
   501â†’      {/* Stats Panel */}
   502â†’      <StatsPanel stats={stats} />
   503â†’
   504â†’      {/* Open Positions */}
   505â†’      {positions.length > 0 && (
   506â†’        <div className="flex-shrink-0">
   507â†’          <div className="text-text-secondary mb-2 flex items-center gap-2 text-xs font-medium">
   508â†’            <Target className="h-3.5 w-3.5" />
   509â†’            Open Positions ({positions.length})
   510â†’          </div>
   511â†’          <div className="max-h-40 space-y-2 overflow-auto">
   512â†’            {positions.map((pos) => (
   513â†’              <PositionCard key={pos.mint} position={pos} />
   514â†’            ))}
   515â†’          </div>
   516â†’        </div>
   517â†’      )}
   518â†’
   519â†’      {/* Watched Token Lists - Main scrollable area */}
   520â†’      <div className="flex min-h-0 flex-1 flex-col gap-3 overflow-auto">
   521â†’        {/* Watchlist */}
   522â†’        <TokenListSection
   523â†’          title="Watchlist"
   524â†’          icon={Eye}
   525â†’          tokens={tokenList.watchlist}
   526â†’          iconColor="text-blue-400"
   527â†’        />
   528â†’
   529â†’        {/* Trending */}
   530â†’        <TokenListSection
   531â†’          title="Trending"
   532â†’          icon={Flame}
   533â†’          tokens={tokenList.trending}
   534â†’          iconColor="text-orange-400"
   535â†’        />
   536â†’
   537â†’        {/* Whale Moves */}
   538â†’        <TokenListSection
   539â†’          title="Whale Moves"
   540â†’          icon={Wallet}
   541â†’          tokens={tokenList.whales}
   542â†’          iconColor="text-green-400"
   543â†’        />
   544â†’
   545â†’        {/* Empty state if no tokens */}
   546â†’        {totalTokens === 0 && isConnected && (
   547â†’          <div className="text-text-secondary border-border-primary/50 rounded-lg border border-dashed p-4 text-center text-xs">
   548â†’            No tokens being watched. Enable auto-sources or add to watchlist.
   549â†’          </div>
   550â†’        )}
   551â†’      </div>
   552â†’
   553â†’      {/* Signal Feed - Collapsible at bottom */}
   554â†’      {signals.length > 0 && (
   555â†’        <div className="flex-shrink-0 border-t border-border-primary/30 pt-2">
   556â†’          <div className="text-text-secondary mb-1.5 flex items-center gap-2 text-xs font-medium">
   557â†’            <Zap className="h-3.5 w-3.5" />
   558â†’            Recent Signals
   559â†’          </div>
   560â†’          <div className="max-h-24 overflow-auto">
   561â†’            <div className="space-y-0">
   562â†’              {signals.slice(0, 5).map((signal, idx) => (
   563â†’                <SignalItem key={`${signal.timestamp}-${idx}`} signal={signal} />
   564â†’              ))}
   565â†’            </div>
   566â†’          </div>
   567â†’        </div>
   568â†’      )}
   569â†’    </div>
   570â†’  );
   571â†’};
   572â†’
   573â†’export default AutopilotWidget;
   574â†’