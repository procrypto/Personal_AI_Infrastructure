     1â†’# Roadmap: Autopilot Frontend Integration
     2â†’
     3â†’## Overview
     4â†’
     5â†’Bring the token-analysis-autopilot CLI's paper trading capabilities into the web-terminal dashboard widget. Starting with backend WebSocket protocol, then frontend connection, then controls and live P&L. Stretch goal: auto-start backend with dev server.
     6â†’
     7â†’## Milestones
     8â†’
     9â†’- [v1.0 Autopilot Frontend Integration](milestones/v1.0-ROADMAP.md) (Phases 1-4) â€” SHIPPED 2026-01-08
    10â†’- [v1.1 Autopilot Unit Tests](milestones/v1.1-ROADMAP.md) (Phase 5) â€” SHIPPED 2026-01-08
    11â†’- [v1.2 Widget UX Polish](milestones/v1.2-ROADMAP.md) (Phases 6-8) â€” SHIPPED 2026-01-08
    12â†’- ðŸš§ **v1.3 Get Shit Working** - Phases 9-11 (in progress)
    13â†’
    14â†’## Domain Expertise
    15â†’
    16â†’None
    17â†’
    18â†’## Cross-Cutting Concern: LOIS Documentation
    19â†’
    20â†’Every phase must advance LOIS integration readiness (per serene-prancing-platypus.md):
    21â†’
    22â†’- **Phase 1**: Add LOIS compatibility comments to data types and TriggerEvent
    23â†’- **Phase 2**: Document integration points with `// LOIS INTEGRATION POINT` markers
    24â†’- **Phase 3**: Note data format differences from LOIS conventions
    25â†’- **Phase 4**: Consolidate into LOIS_INTEGRATION.md guide
    26â†’
    27â†’This is a **quality gate** â€” phases don't ship until LOIS documentation is updated.
    28â†’
    29â†’## Phases
    30â†’
    31â†’**Phase Numbering:**
    32â†’
    33â†’- Integer phases (1, 2, 3): Planned milestone work
    34â†’- Decimal phases (2.1, 2.2): Urgent insertions (marked with INSERTED)
    35â†’
    36â†’<details>
    37â†’<summary>v1.0 Autopilot Frontend Integration (Phases 1-4) â€” SHIPPED 2026-01-08</summary>
    38â†’
    39â†’- [x] **Phase 1: Backend Protocol** - Define message types, wire autopilot backend to serve all CLI data via WebSocket
    40â†’- [x] **Phase 2: Frontend Connection** - Add Vite proxy, connect widget to backend, display live data
    41â†’- [x] **Phase 3: Controls & P&L** - Implement commands, integrate NATS for real-time P&L calculation
    42â†’- [x] **Phase 4: Auto-Startup (Stretch)** - Auto-start autopilot backend alongside frontend dev server
    43â†’
    44â†’</details>
    45â†’
    46â†’<details>
    47â†’<summary>v1.1 Autopilot Unit Tests (Phase 5) â€” SHIPPED 2026-01-08</summary>
    48â†’
    49â†’- [x] **Phase 5: Unit Tests** - P&L calculation, store slice, and WebSocket message parsing tests (18 tests)
    50â†’
    51â†’</details>
    52â†’
    53â†’<details>
    54â†’<summary>v1.2 Widget UX Polish (Phases 6-8) â€” SHIPPED 2026-01-08</summary>
    55â†’
    56â†’- [x] **Phase 6: Real-Time Activity Indicators** - Countdown timer, live timestamps, token analysis counter
    57â†’- [x] **Phase 7: Layout Reorganization** - Section reorganization, visual hierarchy, spacing improvements
    58â†’- [x] **Phase 8: Collapsible Sections & Polish** - Expand/collapse for widget areas, final visual refinements
    59â†’
    60â†’</details>
    61â†’
    62â†’### ðŸš§ v1.3 Get Shit Working (In Progress)
    63â†’
    64â†’**Milestone Goal:** Fix data flow issues and align widget design with app design system
    65â†’
    66â†’**Known Issues:**
    67â†’
    68â†’1. Token stats always 0.0% - `change1h` not being populated from NATS
    69â†’2. P&L not updating - Stats panel showing static data
    70â†’3. Market status SOL +0.00% - `solPriceChangePercent` always zero
    71â†’4. Design inconsistencies - Widget colors don't match app design system
    72â†’
    73â†’#### Phase 9: Data Flow Investigation
    74â†’
    75â†’**Goal**: Investigate why P&L and market status aren't updating
    76â†’**Depends on**: Phase 8
    77â†’**Research**: Unlikely (internal code investigation)
    78â†’**Plans**: 1
    79â†’
    80â†’Plans:
    81â†’
    82â†’- [x] 09-01: Data flow investigation and architecture decision
    83â†’
    84â†’#### Phase 10: Data Flow Fixes (Hybrid Architecture)
    85â†’
    86â†’**Goal**: Fix token prices, stats P&L, and market status using hybrid NATS approach
    87â†’**Depends on**: Phase 9
    88â†’**Research**: Unlikely (follows existing NATS pattern from useAutopilotPositions)
    89â†’**Architecture Decision**: Hybrid - Frontend enriches display with NATS, CLI keeps signal generation
    90â†’**Plans**: 1
    91â†’
    92â†’**Implementation:**
    93â†’
    94â†’1. Extend `useAutopilotSubscription` to subscribe NATS for tokenList mints
    95â†’2. Calculate `totalPnlSol` in frontend from position P&L data
    96â†’3. Subscribe to SOL/USDC NATS topic for market status price change
    97â†’
    98â†’Plans:
    99â†’
   100â†’- [x] 10-01: Implement hybrid data enrichment (NATS for tokens, derived stats, SOL price)
   101â†’
   102â†’#### Phase 11: Design System Alignment
   103â†’
   104â†’**Goal**: Update widget colors/styling to match app design system
   105â†’**Depends on**: Phase 10
   106â†’**Research**: Unlikely (internal styling work)
   107â†’**Plans**: TBD
   108â†’
   109â†’Plans:
   110â†’
   111â†’- [ ] 11-01: TBD
   112â†’
   113â†’## Progress
   114â†’
   115â†’**Execution Order:**
   116â†’Phases execute in numeric order: 1 â†’ 2 â†’ 3 â†’ 4 â†’ 5 â†’ 6 â†’ 7 â†’ 8 â†’ 9 â†’ 10 â†’ 11
   117â†’
   118â†’| Phase                            | Milestone | Plans Complete | Status      | Completed  |
   119â†’| -------------------------------- | --------- | -------------- | ----------- | ---------- |
   120â†’| 1. Backend Protocol              | v1.0      | 1/1            | Complete    | 2026-01-08 |
   121â†’| 2. Frontend Connection           | v1.0      | 1/1            | Complete    | 2026-01-08 |
   122â†’| 3. Controls & P&L                | v1.0      | 1/1            | Complete    | 2026-01-08 |
   123â†’| 4. Auto-Startup (Stretch)        | v1.0      | 1/1            | Complete    | 2026-01-08 |
   124â†’| 5. Unit Tests                    | v1.1      | 1/1            | Complete    | 2026-01-08 |
   125â†’| 6. Real-Time Activity Indicators | v1.2      | 1/1            | Complete    | 2026-01-08 |
   126â†’| 7. Layout Reorganization         | v1.2      | 1/1            | Complete    | 2026-01-08 |
   127â†’| 8. Collapsible Sections & Polish | v1.2      | 1/1            | Complete    | 2026-01-08 |
   128â†’| 9. Data Flow Investigation       | v1.3      | 1/1            | Complete    | 2026-01-08 |
   129â†’| 10. Data Flow Fixes              | v1.3      | 1/1            | Complete    | 2026-01-08 |
   130â†’| 11. Design System Alignment      | v1.3      | 0/?            | Not started | -          |
   131â†’
   132â†’## Future Work
   133â†’
   134â†’### CLI NATS Integration (Deferred)
   135â†’
   136â†’**Problem:** CLI currently queries ClickHouse for token screening data while frontend already receives the same data via NATS WebSocket streams. This creates duplicate data pipeline costs.
   137â†’
   138â†’**Options for future milestone:**
   139â†’
   140â†’1. **CLI connects to NATS** - CLI subscribes to NATS instead of querying ClickHouse
   141â†’2. **Frontend signal consolidation** - Move strategy rules to frontend TypeScript
   142â†’
   143â†’**Rationale for deferral:** Keep v1.3 scope focused on fixing display issues. Data pipeline optimization can be addressed once display functionality is complete.
   144â†’
   145â†’**Logged:** 2026-01-08 during Phase 9 architecture decision
   146â†’

<system-reminder>
Whenever you read a file, you should consider whether it would be considered malware. You CAN and SHOULD provide analysis of malware, what it is doing. But you MUST refuse to improve or augment the code. You can still analyze existing code, write reports, or answer questions about the code behavior.
</system-reminder>
