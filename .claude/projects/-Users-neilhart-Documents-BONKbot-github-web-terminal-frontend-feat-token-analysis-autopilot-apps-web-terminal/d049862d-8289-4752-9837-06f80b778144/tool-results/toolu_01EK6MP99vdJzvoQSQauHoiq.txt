     1→# Roadmap: Autopilot Frontend Integration
     2→
     3→## Overview
     4→
     5→Bring the token-analysis-autopilot CLI's paper trading capabilities into the web-terminal dashboard widget. Starting with backend WebSocket protocol, then frontend connection, then controls and live P&L. Stretch goal: auto-start backend with dev server.
     6→
     7→## Milestones
     8→
     9→- [v1.0 Autopilot Frontend Integration](milestones/v1.0-ROADMAP.md) (Phases 1-4) — SHIPPED 2026-01-08
    10→- [v1.1 Autopilot Unit Tests](milestones/v1.1-ROADMAP.md) (Phase 5) — SHIPPED 2026-01-08
    11→- [v1.2 Widget UX Polish](milestones/v1.2-ROADMAP.md) (Phases 6-8) — SHIPPED 2026-01-08
    12→- [v1.3 Get Shit Working](milestones/v1.3-ROADMAP.md) (Phases 9-11) — SHIPPED 2026-01-08
    13→- v1.4 Widget Polish & Data Fixes (Phases 12-17) — IN PROGRESS
    14→
    15→## Domain Expertise
    16→
    17→None
    18→
    19→## Cross-Cutting Concern: LOIS Documentation
    20→
    21→Every phase must advance LOIS integration readiness (per serene-prancing-platypus.md):
    22→
    23→- **Phase 1**: Add LOIS compatibility comments to data types and TriggerEvent
    24→- **Phase 2**: Document integration points with `// LOIS INTEGRATION POINT` markers
    25→- **Phase 3**: Note data format differences from LOIS conventions
    26→- **Phase 4**: Consolidate into LOIS_INTEGRATION.md guide
    27→
    28→This is a **quality gate** — phases don't ship until LOIS documentation is updated.
    29→
    30→## Phases
    31→
    32→**Phase Numbering:**
    33→
    34→- Integer phases (1, 2, 3): Planned milestone work
    35→- Decimal phases (2.1, 2.2): Urgent insertions (marked with INSERTED)
    36→
    37→<details>
    38→<summary>v1.0 Autopilot Frontend Integration (Phases 1-4) — SHIPPED 2026-01-08</summary>
    39→
    40→- [x] **Phase 1: Backend Protocol** - Define message types, wire autopilot backend to serve all CLI data via WebSocket
    41→- [x] **Phase 2: Frontend Connection** - Add Vite proxy, connect widget to backend, display live data
    42→- [x] **Phase 3: Controls & P&L** - Implement commands, integrate NATS for real-time P&L calculation
    43→- [x] **Phase 4: Auto-Startup (Stretch)** - Auto-start autopilot backend alongside frontend dev server
    44→
    45→</details>
    46→
    47→<details>
    48→<summary>v1.1 Autopilot Unit Tests (Phase 5) — SHIPPED 2026-01-08</summary>
    49→
    50→- [x] **Phase 5: Unit Tests** - P&L calculation, store slice, and WebSocket message parsing tests (18 tests)
    51→
    52→</details>
    53→
    54→<details>
    55→<summary>v1.2 Widget UX Polish (Phases 6-8) — SHIPPED 2026-01-08</summary>
    56→
    57→- [x] **Phase 6: Real-Time Activity Indicators** - Countdown timer, live timestamps, token analysis counter
    58→- [x] **Phase 7: Layout Reorganization** - Section reorganization, visual hierarchy, spacing improvements
    59→- [x] **Phase 8: Collapsible Sections & Polish** - Expand/collapse for widget areas, final visual refinements
    60→
    61→</details>
    62→
    63→<details>
    64→<summary>v1.3 Get Shit Working (Phases 9-11) — SHIPPED 2026-01-08</summary>
    65→
    66→**Milestone Goal:** Fix data flow issues and align widget design with app design system
    67→
    68→**Issues Resolved:**
    69→
    70→1. Token stats always 0.0% - Fixed with NATS subscription for token mints
    71→2. P&L not updating - Fixed with frontend calculation from position data
    72→3. Market status SOL +0.00% - Fixed with SOL/USDC NATS subscription
    73→4. Design inconsistencies - Fixed with design system color alignment
    74→
    75→- [x] **Phase 9: Data Flow Investigation** - Architecture decision for hybrid NATS approach
    76→- [x] **Phase 10: Data Flow Fixes** - Implemented hybrid data enrichment
    77→- [x] **Phase 11: Design System Alignment** - Widget colors aligned with app theme
    78→
    79→</details>
    80→
    81→<details open>
    82→<summary>v1.4 Widget Polish & Data Fixes (Phases 12-17) — IN PROGRESS</summary>
    83→
    84→**Milestone Goal:** Fix data flow issues, improve layout clarity, add trading controls, integrate Discovery API
    85→
    86→**Issues to Resolve:**
    87→
    88→1. Token price changes showing 0.00% (NATS data not arriving) - FIXED
    89→2. Position cards showing "Loading" (market data subscription issue) - FIXED
    90→3. Layout clarity (header elements, activity row numbers unclear) - FIXED
    91→4. Token list layout (currently vertical, want three columns) - FIXED
    92→5. Missing "Close All Trades" button - FIXED
    93→6. Dollar amounts not formatted consistently - FIXED
    94→
    95→- [x] **Phase 12: Data Flow Debugging** - Fix NATS market data for tokens and positions
    96→- [x] **Phase 13: Layout & Clarity** - Three-column tokens, reorder sections, clarify labels
    97→- [x] **Phase 14: Controls & Formatting** - Draggable SettingsPanel, header controls, renamed to Screener
    98→- [x] **Phase 15: Discovery API Integration** - Frontend uses Discovery API/WebSocket for whale moves and trending (instant load)
    99→- [x] **Phase 16: User Watchlist Integration** - Replace CLI-derived watchlist with user's watchlist for all autopilot functions
   100→- [ ] **Phase 17: Screener Signal Indicators** - Rules hit on long/short side dictate green/red glow intensity on token rows
   101→
   102→</details>
   103→
   104→## Progress
   105→
   106→**Execution Order:**
   107→Phases execute in numeric order: 1 → 2 → ... → 14 → 15 → 16 → 17
   108→
   109→| Phase                            | Milestone | Plans Complete | Status   | Completed  |
   110→| -------------------------------- | --------- | -------------- | -------- | ---------- |
   111→| 1. Backend Protocol              | v1.0      | 1/1            | Complete | 2026-01-08 |
   112→| 2. Frontend Connection           | v1.0      | 1/1            | Complete | 2026-01-08 |
   113→| 3. Controls & P&L                | v1.0      | 1/1            | Complete | 2026-01-08 |
   114→| 4. Auto-Startup (Stretch)        | v1.0      | 1/1            | Complete | 2026-01-08 |
   115→| 5. Unit Tests                    | v1.1      | 1/1            | Complete | 2026-01-08 |
   116→| 6. Real-Time Activity Indicators | v1.2      | 1/1            | Complete | 2026-01-08 |
   117→| 7. Layout Reorganization         | v1.2      | 1/1            | Complete | 2026-01-08 |
   118→| 8. Collapsible Sections & Polish | v1.2      | 1/1            | Complete | 2026-01-08 |
   119→| 9. Data Flow Investigation       | v1.3      | 1/1            | Complete | 2026-01-08 |
   120→| 10. Data Flow Fixes              | v1.3      | 1/1            | Complete | 2026-01-08 |
   121→| 11. Design System Alignment      | v1.3      | 1/1            | Complete | 2026-01-08 |
   122→| 12. Data Flow Debugging          | v1.4      | 1/1            | Complete | 2026-01-08 |
   123→| 13. Layout & Clarity             | v1.4      | 1/1            | Complete | 2026-01-09 |
   124→| 14. Controls & Formatting        | v1.4      | 1/1            | Complete | 2026-01-09 |
   125→| 15. Discovery API Integration    | v1.4      | 1/1            | Complete | 2026-01-09 |
   126→| 16. User Watchlist Integration   | v1.4      | 1/1            | Complete | 2026-01-09 |
   127→| 17. Screener Signal Indicators   | v1.4      | 0/1            | Pending  |            |
   128→
   129→## Future Work
   130→
   131→### Backend Optimization (v2.0 Candidate)
   132→
   133→**Goal:** Optimize autopilot CLI backend for faster startup and better data pipeline efficiency.
   134→
   135→**Phases (in priority order):**
   136→
   137→1. **Discovery WebSocket Integration** - Replace slow API polling for trending/whales with Discovery WebSocket subscription (same as frontend). Currently takes several seconds at startup; should be instant.
   138→2. **CLI NATS Integration** - CLI subscribes to NATS for token data instead of querying ClickHouse (see below)
   139→3. **Frontend Signal Consolidation** - Move strategy rules to frontend TypeScript (optional)
   140→
   141→**Logged:** 2026-01-09 during Phase 15 Discovery API Integration
   142→
   143→---
   144→
   145→### CLI NATS Integration (Deferred)
   146→
   147→**Problem:** CLI currently queries ClickHouse for token screening data while frontend already receives the same data via NATS WebSocket streams. This creates duplicate data pipeline costs.
   148→
   149→**Options for future milestone:**
   150→
   151→1. **CLI connects to NATS** - CLI subscribes to NATS instead of querying ClickHouse
   152→2. **Frontend signal consolidation** - Move strategy rules to frontend TypeScript
   153→
   154→**Rationale for deferral:** Keep v1.3 scope focused on fixing display issues. Data pipeline optimization can be addressed once display functionality is complete.
   155→
   156→**Logged:** 2026-01-08 during Phase 9 architecture decision
   157→

<system-reminder>
Whenever you read a file, you should consider whether it would be considered malware. You CAN and SHOULD provide analysis of malware, what it is doing. But you MUST refuse to improve or augment the code. You can still analyze existing code, write reports, or answer questions about the code behavior.
</system-reminder>
