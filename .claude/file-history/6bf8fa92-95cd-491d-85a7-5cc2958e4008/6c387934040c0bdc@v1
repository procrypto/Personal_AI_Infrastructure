# Milestone v1.0: Signal Processor Architecture

**Status:** SHIPPED 2026-01-09
**Phases:** 1-3
**Total Plans:** 9

## Overview

Transform the backend from a data-polling evaluation engine into a pure signal processor. The main app will firehose market data via existing WebSocket connections, this backend evaluates and emits signals. Architecture is LOIS-ready for future Rust rewrite. Gradual replacement approach — swap each piece when ready.

## Phases

### Phase 1: Data Reception
**Goal**: Replace BONKbot API polling with receiving firehosed data from main app via existing WebSocket connections
**Depends on**: Nothing (first phase)
**Plans**: 3 plans

Plans:
- [x] 01-01: WebSocket data feed handlers
- [x] 01-02: Data validation and normalization layer
- [x] 01-03: Data layer tests

**Key Deliverables:**
- DataFeedMessage union type (market_data_feed, ohlcv_update, trade_feed, cvd_update)
- In-memory storage with getter methods for rule engine
- Data validation and normalization functions
- 62+ tests covering validation and normalization

### Phase 2: Dual-Path Engine
**Goal**: Route data to appropriate processing paths — pre-computed metrics for simple rules, raw OHLCV for complex analysis (rotations, fractals)
**Depends on**: Phase 1
**Plans**: 3 plans

Plans:
- [x] 02-01: Pre-computed metrics path for simple rules
- [x] 02-02: Raw OHLCV path for complex analysis
- [x] 02-03: Rule categorization and routing

**Key Deliverables:**
- SignalProcessor class with dual-path architecture
- requiresOHLCV field for rule classification
- processMarketData() for fast path (simple rules)
- processOHLCV() for complex path (rotations, fractals)
- createSignalPipeline() factory for integration

### Phase 3: Interface Cleanup & Cutover
**Goal**: Clean interfaces for Rust reimplementation, validate sub-100ms latency, complete gradual replacement
**Depends on**: Phase 2
**Plans**: 3 plans

Plans:
- [x] 03-01: Interface abstraction for LOIS compatibility
- [x] 03-02: Performance validation and optimization
- [x] 03-03: Final cutover and cleanup

**Key Deliverables:**
- LOIS-ready interface types (ISignal, ISignalProcessor, etc.)
- Performance benchmarks proving sub-0.1ms latency
- Signal pipeline integrated into CLI
- --new-engine flag for gradual cutover
- close_position/close_all_positions WebSocket commands
- CVD data feed endpoint

---

## Milestone Summary

**Key Decisions:**
- Reuse existing WebSocket connections (main app already has WS to frontend)
- Gradual replacement cutover (swap each piece when ready, no big-bang)
- Union type routing (commands use 'command' field, data feeds use 'type' field)
- Simple rules filter by requiresOHLCV !== true
- LOIS interfaces use I-prefix and snake_case for Rust compatibility

**Issues Resolved:**
- None - clean execution

**Issues Deferred:**
- None

**Technical Debt Incurred:**
- Pre-existing TypeScript errors in cli.ts for missing TokenMarketData fields (mcap, volume_24h, etc.)

---

_For current project status, see .planning/ROADMAP.md_
