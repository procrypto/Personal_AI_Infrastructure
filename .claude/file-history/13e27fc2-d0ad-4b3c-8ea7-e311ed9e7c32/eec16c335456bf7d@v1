# Roadmap: TrenchBench Branch Unification

## Overview

Merge feat/dash-pauls (37 UI commits) into feat/dash-pauls-preload-data (unified trenchBenchStore architecture), creating feat/trenchbench-unified with feature parity. Start with branch setup and conflict resolution, implement all UI features widget-by-widget, then migrate from hybrid CustomEvents+Store to pure store-based sync.

## Domain Expertise

None

## Phases

**Phase Numbering:**
- Integer phases (1, 2, 3): Planned milestone work
- Decimal phases (2.1, 2.2): Urgent insertions (marked with INSERTED)

- [x] **Phase 1: Branch Foundation** - Create unified branch, resolve merge conflicts
- [ ] **Phase 2: Intel Grid Features** - Pause-on-hover, chart refresh, badge logic
- [ ] **Phase 3: Cross-Widget Sync** - Selection sync with hybrid events+store
- [ ] **Phase 4: Data Accuracy** - Lamports/SOL detection, PNL fixes, connection removal
- [ ] **Phase 5: Anomalyzer & Exfil** - Deduplication, expandable sections, session P/L
- [ ] **Phase 6: Store Migration** - Validate store data, remove CustomEvents
- [ ] **Phase 7: Integration & PR** - Final testing, documentation, PR prep

## Phase Details

### Phase 1: Branch Foundation
**Goal**: Create feat/trenchbench-unified branch with both codebases merged and conflicts resolved
**Depends on**: Nothing (first phase)
**Research**: Unlikely (git operations, internal codebase)
**Plans**: 2 (01-01: branch+intel-grid, 01-02: vantage+anomalyzer+build)

Key work:
- Create new branch from preload-data base
- Merge dash-pauls commits
- Resolve conflicts in: intel-grid-widget.tsx, vantage-widget.tsx, anomalyzer-widget.tsx, exfil-widget.tsx
- Validate both stores coexist and app builds

### Phase 2: Intel Grid Features
**Goal**: Intel Grid widget has all dash-pauls features working
**Depends on**: Phase 1
**Research**: Unlikely (internal patterns)
**Plans**: TBD

Key work:
- Pause-on-hover functionality
- HOT/TRENDING badge logic (3+ KOLs holding >50%)
- Chart refresh mechanism (prevent blanking)

### Phase 3: Cross-Widget Sync
**Goal**: Selection syncs correctly between Intel Grid, Vantage, and Anomalyzer
**Depends on**: Phase 2
**Research**: Unlikely (documented in PROJECT.md)
**Plans**: TBD

Key work:
- Intel Grid ↔ Vantage ↔ Anomalyzer token selection
- Store subscriptions parallel to CustomEvents (hybrid approach)
- Validate sync works in both directions

### Phase 4: Data Accuracy
**Goal**: Data displays correctly with proper units and accurate PNL
**Depends on**: Phase 3
**Research**: Unlikely (backend integration patterns)
**Plans**: TBD

Key work:
- Lamports vs SOL smart detection
- User PNL accuracy fixes (use backend pnl_total_usd)
- Connection removal when KOLs sell

### Phase 5: Anomalyzer & Exfil
**Goal**: Anomalyzer and Exfil widgets have all dash-pauls features
**Depends on**: Phase 4
**Research**: Unlikely (internal patterns)
**Plans**: TBD

Key work:
- Anomalyzer deduplication (same trader+token within 5 min)
- Exfil open positions expandable section
- Session P/L tracking in Exfil

### Phase 6: Store Migration
**Goal**: Pure store-based sync replaces CustomEvents
**Depends on**: Phase 5
**Research**: Unlikely (internal validation)
**Plans**: TBD

Key work:
- Validate positionsByToken has all needed holder data
- Test store-based sync works correctly
- Remove CustomEvent listeners
- Verify no regressions

### Phase 7: Integration & PR
**Goal**: Unified branch ready for PR and review
**Depends on**: Phase 6
**Research**: Unlikely (internal)
**Plans**: TBD

Key work:
- Final testing across all widgets
- Documentation updates
- PR preparation with clear description
- Code review readiness

## Progress

**Execution Order:**
Phases execute in numeric order: 1 → 2 → 3 → 4 → 5 → 6 → 7

| Phase | Plans Complete | Status | Completed |
|-------|----------------|--------|-----------|
| 1. Branch Foundation | 2/2 | Complete | 2026-01-13 |
| 2. Intel Grid Features | 1/TBD | In progress | - |
| 3. Cross-Widget Sync | 0/TBD | Not started | - |
| 4. Data Accuracy | 0/TBD | Not started | - |
| 5. Anomalyzer & Exfil | 0/TBD | Not started | - |
| 6. Store Migration | 0/TBD | Not started | - |
| 7. Integration & PR | 0/TBD | Not started | - |
