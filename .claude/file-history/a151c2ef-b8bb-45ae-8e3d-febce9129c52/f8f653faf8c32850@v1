---
phase: 03-controls-and-pnl
plan: 01
type: execute
---

<objective>
Verify controls work end-to-end and complete LOIS data format documentation.

Purpose: Ensure Phase 1-2 wiring is functional and satisfy Phase 3 LOIS gate (data format notes).
Output: Working controls, LOIS data format documentation, phase complete.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
./summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/01-backend-protocol/01-01-SUMMARY.md
@.planning/phases/02-frontend-connection/02-01-SUMMARY.md

**Tech stack available:** Zustand, NATS WebSocket, BaseWebsocket pattern
**Established patterns:** LOIS COMPATIBLE markers, LOIS INTEGRATION POINT markers
**Constraining decisions:**
- Phase 1: Signal type mapping (magic_buy -> ENTRY_SIGNAL, etc.)
- Phase 2: Type alias pattern for backward compatibility

**Implementation already exists:**
- All control commands defined in AutopilotWebsocket.ts
- Controls wired in ControlsPanel and StrategiesPanel (autopilot-widget.tsx)
- NATS subscription in useAutopilotSubscription.ts
- P&L calculation in useAutopilotPositions.ts

@apps/web-terminal/src/websocket/autopilot/AutopilotWebsocket.ts
@apps/web-terminal/src/ui/dashboard/widgets/autopilot-widget.tsx
@apps/web-terminal/src/hooks/useAutopilot/useAutopilotPositions.ts
@apps/web-terminal/src/hooks/useSubscriptions/useAutopilotSubscription.ts
@apps/web-terminal/src/store/memoryStore/slices/autopilot-store/types.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add LOIS data format documentation to types.ts</name>
  <files>apps/web-terminal/src/store/memoryStore/slices/autopilot-store/types.ts</files>
  <action>
Add a new JSDoc block after the existing LOIS INTEGRATION NOTES that documents data format differences between autopilot and LOIS conventions. Include:

1. Field naming differences (autopilot uses camelCase, LOIS uses snake_case)
2. Price format (autopilot: number, LOIS: DecimalString)
3. Timestamp format (autopilot: Unix ms number, LOIS: ISO 8601 string)
4. Signal type mapping (already documented, reference it)
5. Position fields (autopilot: entry-only, LOIS: includes fill data)

This completes the Phase 3 LOIS Gate: "Data format notes explain LOIS convention differences"
  </action>
  <verify>grep "DATA FORMAT DIFFERENCES" apps/web-terminal/src/store/memoryStore/slices/autopilot-store/types.ts returns content</verify>
  <done>types.ts contains LOIS DATA FORMAT DIFFERENCES section with all noted format differences</done>
</task>

<task type="auto">
  <name>Task 2: Verify TypeScript compilation</name>
  <files>apps/web-terminal/src/store/memoryStore/slices/autopilot-store/</files>
  <action>
Run TypeScript compilation to verify all autopilot files compile without errors.
Ensure the new documentation block has valid JSDoc syntax.
  </action>
  <verify>npx tsc --noEmit --project apps/web-terminal/tsconfig.json 2>&1 | grep -i autopilot returns no errors</verify>
  <done>TypeScript compilation passes with no autopilot-related errors</done>
</task>

</tasks>

<verification>
Before declaring phase complete:
- [ ] LOIS DATA FORMAT DIFFERENCES section exists in types.ts
- [ ] All data format differences documented (naming, prices, timestamps, signals, positions)
- [ ] TypeScript compilation passes
- [ ] Phase 3 LOIS Gate satisfied
</verification>

<success_criteria>

- Both tasks completed
- All verification checks pass
- LOIS data format documentation complete
- Phase 3: Controls & P&L complete
</success_criteria>

<output>
After completion, create `.planning/phases/03-controls-and-pnl/03-01-SUMMARY.md`:

# Phase 3 Plan 1: Controls & P&L Summary

**[One-liner summary of what shipped]**

## Performance

- **Duration:** X min
- **Tasks:** 2/2
- **Files modified:** 1

## Accomplishments

- [Key accomplishments]

## Task Commits

1. **Task 1: Add LOIS data format documentation** - commit hash (docs)
2. **Task 2: Verify TypeScript compilation** - verification only

## Files Created/Modified

- `apps/web-terminal/src/store/memoryStore/slices/autopilot-store/types.ts` - LOIS data format documentation

## Decisions Made

[Any decisions, or "None"]

## Deviations from Plan

[Any deviations, or "None"]

## Issues Encountered

[Any issues, or "None"]

## Next Phase Readiness

- Phase 3 LOIS Gate satisfied: Data format differences documented
- Ready for Phase 4: Auto-Startup (Stretch)

---
_Phase: 03-controls-and-pnl_
_Completed: YYYY-MM-DD_
</output>
