# Roadmap: Autopilot Frontend Integration

## Overview

Bring the token-analysis-autopilot CLI's paper trading capabilities into the web-terminal dashboard widget. Starting with backend WebSocket protocol, then frontend connection, then controls and live P&L. Stretch goal: auto-start backend with dev server.

## Milestones

- [v1.0 Autopilot Frontend Integration](milestones/v1.0-ROADMAP.md) (Phases 1-4) â€” SHIPPED 2026-01-08
- [v1.1 Autopilot Unit Tests](milestones/v1.1-ROADMAP.md) (Phase 5) â€” SHIPPED 2026-01-08
- [v1.2 Widget UX Polish](milestones/v1.2-ROADMAP.md) (Phases 6-8) â€” SHIPPED 2026-01-08
- ðŸš§ **v1.3 Get Shit Working** - Phases 9-11 (in progress)

## Domain Expertise

None

## Cross-Cutting Concern: LOIS Documentation

Every phase must advance LOIS integration readiness (per serene-prancing-platypus.md):

- **Phase 1**: Add LOIS compatibility comments to data types and TriggerEvent
- **Phase 2**: Document integration points with `// LOIS INTEGRATION POINT` markers
- **Phase 3**: Note data format differences from LOIS conventions
- **Phase 4**: Consolidate into LOIS_INTEGRATION.md guide

This is a **quality gate** â€” phases don't ship until LOIS documentation is updated.

## Phases

**Phase Numbering:**

- Integer phases (1, 2, 3): Planned milestone work
- Decimal phases (2.1, 2.2): Urgent insertions (marked with INSERTED)

<details>
<summary>v1.0 Autopilot Frontend Integration (Phases 1-4) â€” SHIPPED 2026-01-08</summary>

- [x] **Phase 1: Backend Protocol** - Define message types, wire autopilot backend to serve all CLI data via WebSocket
- [x] **Phase 2: Frontend Connection** - Add Vite proxy, connect widget to backend, display live data
- [x] **Phase 3: Controls & P&L** - Implement commands, integrate NATS for real-time P&L calculation
- [x] **Phase 4: Auto-Startup (Stretch)** - Auto-start autopilot backend alongside frontend dev server

</details>

<details>
<summary>v1.1 Autopilot Unit Tests (Phase 5) â€” SHIPPED 2026-01-08</summary>

- [x] **Phase 5: Unit Tests** - P&L calculation, store slice, and WebSocket message parsing tests (18 tests)

</details>

<details>
<summary>v1.2 Widget UX Polish (Phases 6-8) â€” SHIPPED 2026-01-08</summary>

- [x] **Phase 6: Real-Time Activity Indicators** - Countdown timer, live timestamps, token analysis counter
- [x] **Phase 7: Layout Reorganization** - Section reorganization, visual hierarchy, spacing improvements
- [x] **Phase 8: Collapsible Sections & Polish** - Expand/collapse for widget areas, final visual refinements

</details>

### ðŸš§ v1.3 Get Shit Working (In Progress)

**Milestone Goal:** Fix data flow issues and align widget design with app design system

**Known Issues:**

1. Token stats always 0.0% - `change1h` not being populated from NATS
2. P&L not updating - Stats panel showing static data
3. Market status SOL +0.00% - `solPriceChangePercent` always zero
4. Design inconsistencies - Widget colors don't match app design system

#### Phase 9: Data Flow Investigation

**Goal**: Investigate why P&L and market status aren't updating
**Depends on**: Phase 8
**Research**: Unlikely (internal code investigation)
**Plans**: TBD

Plans:

- [ ] 09-01: TBD (run /gsd:plan-phase 9 to break down)

#### Phase 10: Data Flow Fixes (Hybrid Architecture)

**Goal**: Fix token prices, stats P&L, and market status using hybrid NATS approach
**Depends on**: Phase 9
**Research**: Unlikely (follows existing NATS pattern from useAutopilotPositions)
**Architecture Decision**: Hybrid - Frontend enriches display with NATS, CLI keeps signal generation
**Plans**: 1

**Implementation:**
1. Extend `useAutopilotSubscription` to subscribe NATS for tokenList mints
2. Calculate `totalPnlSol` in frontend from position P&L data
3. Subscribe to SOL/USDC NATS topic for market status price change

Plans:

- [ ] 10-01: Implement hybrid data enrichment (NATS for tokens, derived stats, SOL price)

#### Phase 11: Design System Alignment

**Goal**: Update widget colors/styling to match app design system
**Depends on**: Phase 10
**Research**: Unlikely (internal styling work)
**Plans**: TBD

Plans:

- [ ] 11-01: TBD

## Progress

**Execution Order:**
Phases execute in numeric order: 1 â†’ 2 â†’ 3 â†’ 4 â†’ 5 â†’ 6 â†’ 7 â†’ 8 â†’ 9 â†’ 10 â†’ 11

| Phase                            | Milestone | Plans Complete | Status      | Completed  |
| -------------------------------- | --------- | -------------- | ----------- | ---------- |
| 1. Backend Protocol              | v1.0      | 1/1            | Complete    | 2026-01-08 |
| 2. Frontend Connection           | v1.0      | 1/1            | Complete    | 2026-01-08 |
| 3. Controls & P&L                | v1.0      | 1/1            | Complete    | 2026-01-08 |
| 4. Auto-Startup (Stretch)        | v1.0      | 1/1            | Complete    | 2026-01-08 |
| 5. Unit Tests                    | v1.1      | 1/1            | Complete    | 2026-01-08 |
| 6. Real-Time Activity Indicators | v1.2      | 1/1            | Complete    | 2026-01-08 |
| 7. Layout Reorganization         | v1.2      | 1/1            | Complete    | 2026-01-08 |
| 8. Collapsible Sections & Polish | v1.2      | 1/1            | Complete    | 2026-01-08 |
| 9. Data Flow Investigation       | v1.3      | 0/?            | Not started | -          |
| 10. Token Price Enrichment       | v1.3      | 0/?            | Not started | -          |
| 11. Design System Alignment      | v1.3      | 0/?            | Not started | -          |
