# Project State

## Project Reference

See: .planning/PROJECT.md (updated 2026-01-08)

**Core value:** Full feature parity with the CLI through the dashboard widget
**Current focus:** Fix data flow issues, improve layout clarity, add trading controls

## Current Position

Phase: 20 (Controls & Accuracy)
Plan: 1 of 1 complete
Status: Phase complete
Last activity: 2026-01-09 — Completed 20-01-PLAN.md (Frontend Close Controls)

Progress: ████████░░ 75% (v1.5) — 3 of 4 phases complete

## Performance Metrics

**Velocity:**

- Total plans completed: 19
- Average duration: 9.2 min
- Total execution time: 2.9 hours

**By Phase:**

| Phase | Plans | Total | Avg/Plan |
| ----- | ----- | ----- | -------- |
| 01    | 1     | 5min  | 5min     |
| 02    | 1     | 2min  | 2min     |
| 03    | 1     | 2min  | 2min     |
| 04    | 1     | 5min  | 5min     |
| 05    | 1     | 9min  | 9min     |
| 06    | 1     | 3min  | 3min     |
| 07    | 1     | 3min  | 3min     |
| 08    | 1     | 4min  | 4min     |
| 09    | 1     | 20min | 20min    |
| 10    | 1     | 8min  | 8min     |
| 11    | 1     | 9min  | 9min     |
| 12    | 1     | 8min  | 8min     |
| 13    | 1     | 48min | 48min    |
| 14    | 1     | 24min | 24min    |
| 18    | 1     | 3min  | 3min     |
| 22    | 3     | 18min | 6min     |
| 20    | 1     | 2min  | 2min     |

**Milestone Summary:**

| Milestone | Phases | Plans | Duration | Shipped    |
| --------- | ------ | ----- | -------- | ---------- |
| v1.0      | 1-4    | 4     | 14min    | 2026-01-08 |
| v1.1      | 5      | 1     | 9min     | 2026-01-08 |
| v1.2      | 6-8    | 3     | 10min    | 2026-01-08 |
| v1.3      | 9-11   | 3     | 37min    | 2026-01-08 |

## Accumulated Context

### Decisions

Decisions are logged in PROJECT.md Key Decisions table.
Key decisions from all milestones:

- LOIS documentation is a cross-cutting quality gate for all phases
- Recommend lois-adapter.ts pattern for format conversions at WebSocket boundary
- Autopilot plugin checks directory existence before spawning
- Extract pure functions for testability (calculatePnL, parseAutopilotEvent)
- Adaptive interval refresh for useTimeAgo (balance responsiveness vs CPU)
- Performance section at top, Configuration at bottom (set-and-forget)
- Only Performance and Activity sections collapsible
- Hybrid architecture: NATS for display prices, CLI for signal generation
- Calculate totalPnlSol in frontend from position data (not CLI stats)
- Defer CLI NATS integration to future milestone (data pipeline optimization)
- Derive SOL/USD price from market data (price_usd / price_sol) as fallback
- Realized P&L = totalPnlSol - unrealizedPnlSol (actual closed trade profit)
- Always show 5-column stats grid with Unrealized (even when no positions)
- Close All button in performance section, disabled when no positions
- Vantage-widget pattern for draggable floating SettingsPanel
- Portal to document.body when panel dragged (escape widget overflow)
- Rename "Tokens" section to "Screener"
- Frontend uses Discovery API/WebSocket for whale moves and trending (instant)
- Backend optimization (Discovery WebSocket integration) deferred to v2.0
- Signal indicators use confluence-based intensity (not time decay)
- Brand palette backgrounds (bg-success/bg-error) for signal highlighting

### Deferred Issues

None.

### Blockers/Concerns

None.

### Roadmap Evolution

- v1.0 archived: Autopilot Frontend Integration (4 phases, 4 plans)
- v1.1 archived: Autopilot Unit Tests (1 phase, 1 plan)
- v1.2 archived: Widget UX Polish (3 phases, 3 plans)
- Milestone v1.3 created: Get Shit Working (3 phases: Phase 9-11)
- Phase 15 added: Discovery API Integration (fast whale moves/trending from Discovery API)
- Phase 16 added: User Watchlist Integration (replace CLI watchlist with user's watchlist)
- Phase 17 added: Screener Signal Indicators (rules hit = green/red glow intensity)
- Milestone v1.5 created: AAT Fixes (4 phases: Phase 18-21)
- Phase 22 added: Watchlist-Style Screener with Volume Trends
- Phase 19 removed: Superseded by Phase 22 (screener alignment covered by watchlist-style table)
- Execution order updated: 18 → 22 → 20 → 21

## Session Continuity

Last session: 2026-01-09
Stopped at: Completed 20-01-PLAN.md (Frontend Close Controls) - Phase 20 complete
Resume file: None
Next action: Plan Phase 21 with `/gsd:plan-phase 21` (AAT Naming)
