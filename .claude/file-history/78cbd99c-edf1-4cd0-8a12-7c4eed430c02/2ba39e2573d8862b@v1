# Roadmap: Autopilot Frontend Integration

## Overview

Bring the token-analysis-autopilot CLI's paper trading capabilities into the web-terminal dashboard widget. Starting with backend WebSocket protocol, then frontend connection, then controls and live P&L. Stretch goal: auto-start backend with dev server.

## Milestones

- âœ… **v1.0 Autopilot Frontend Integration** - Phases 1-4 (shipped 2026-01-08)
- ðŸš§ **v1.1 Autopilot Unit Tests** - Phase 5 (in progress)

## Domain Expertise

None

## Cross-Cutting Concern: LOIS Documentation

Every phase must advance LOIS integration readiness (per serene-prancing-platypus.md):

- **Phase 1**: Add LOIS compatibility comments to data types and TriggerEvent
- **Phase 2**: Document integration points with `// LOIS INTEGRATION POINT` markers
- **Phase 3**: Note data format differences from LOIS conventions
- **Phase 4**: Consolidate into LOIS_INTEGRATION.md guide

This is a **quality gate** â€” phases don't ship until LOIS documentation is updated.

## Phases

**Phase Numbering:**

- Integer phases (1, 2, 3): Planned milestone work
- Decimal phases (2.1, 2.2): Urgent insertions (marked with INSERTED)

- [x] **Phase 1: Backend Protocol** - Define message types, wire autopilot backend to serve all CLI data via WebSocket
- [x] **Phase 2: Frontend Connection** - Add Vite proxy, connect widget to backend, display live data
- [x] **Phase 3: Controls & P&L** - Implement commands, integrate NATS for real-time P&L calculation
- [x] **Phase 4: Auto-Startup (Stretch)** - Auto-start autopilot backend alongside frontend dev server

## Phase Details

### Phase 1: Backend Protocol

**Goal**: Complete WebSocket message protocol and wire autopilot backend to serve positions, signals, stats, config, and strategies
**Depends on**: Nothing (first phase)
**Research**: Unlikely (internal patterns, existing websocket-server.ts foundation)
**LOIS Gate**: TriggerEvent and data types have LOIS compatibility comments
**Plans**: TBD (likely 2-3 plans)

Key work:

- Define TypeScript message types for all backendâ†’frontend data
- Wire autopilot's run loop to emit data over WebSocket
- Implement command handlers for frontendâ†’backend messages
- Add LOIS compatibility documentation to types

### Phase 2: Frontend Connection

**Goal**: Connect widget to autopilot backend and display live positions, signals, stats
**Depends on**: Phase 1
**Research**: Unlikely (existing BaseWebsocket and Zustand patterns)
**LOIS Gate**: Integration points documented with markers
**Plans**: TBD (likely 2 plans)

Key work:

- Add Vite proxy config for autopilot WebSocket (like local-api pattern)
- Complete useAutopilotSubscription hook to parse messages and update store
- Wire AutopilotWidget to display real data from store
- Mark LOIS integration points in trigger.ts

### Phase 3: Controls & P&L

**Goal**: Full feature parity - all CLI controls work from widget, live P&L via NATS
**Depends on**: Phase 2
**Research**: Unlikely (existing NATS market_data subscription patterns)
**LOIS Gate**: Data format notes explain LOIS convention differences
**Plans**: TBD (likely 2-3 plans)

Key work:

- Implement all control commands (toggle strategies, sources, filter)
- Subscribe to NATS market_data for open position mints
- Calculate real-time unrealized P&L in frontend
- Document data format differences from LOIS conventions

### Phase 4: Auto-Startup (Stretch)

**Goal**: Auto-start autopilot backend alongside frontend dev server
**Depends on**: Phase 3
**Research**: Likely (Vite plugin patterns, process management)
**Research topics**: Vite plugin API, child process spawning, graceful shutdown
**LOIS Gate**: Consolidate all LOIS docs into LOIS_INTEGRATION.md
**Plans**: TBD (likely 1-2 plans)

Key work:

- Research Vite plugin or npm script approach
- Implement auto-start mechanism
- Handle graceful shutdown on dev server stop
- Create LOIS_INTEGRATION.md guide for PUM3 team

## Progress

**Execution Order:**
Phases execute in numeric order: 1 â†’ 2 â†’ 3 â†’ 4

| Phase                     | Plans Complete | Status   | Completed  |
| ------------------------- | -------------- | -------- | ---------- |
| 1. Backend Protocol       | 1/1            | Complete | 2026-01-08 |
| 2. Frontend Connection    | 1/1            | Complete | 2026-01-08 |
| 3. Controls & P&L         | 1/1            | Complete | 2026-01-08 |
| 4. Auto-Startup (Stretch) | 1/1            | Complete | 2026-01-08 |

**MILESTONE COMPLETE** - All 4 phases finished on 2026-01-08
