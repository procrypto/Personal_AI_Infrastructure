# Roadmap: Autopilot Frontend Integration

## Overview

Bring the token-analysis-autopilot CLI's paper trading capabilities into the web-terminal dashboard widget. Starting with backend WebSocket protocol, then frontend connection, then controls and live P&L. Stretch goal: auto-start backend with dev server.

## Milestones

- [v1.0 Autopilot Frontend Integration](milestones/v1.0-ROADMAP.md) (Phases 1-4) — SHIPPED 2026-01-08
- [v1.1 Autopilot Unit Tests](milestones/v1.1-ROADMAP.md) (Phase 5) — SHIPPED 2026-01-08
- [v1.2 Widget UX Polish](milestones/v1.2-ROADMAP.md) (Phases 6-8) — SHIPPED 2026-01-08
- [v1.3 Get Shit Working](milestones/v1.3-ROADMAP.md) (Phases 9-11) — SHIPPED 2026-01-08
- v1.4 Widget Polish & Data Fixes (Phases 12-17) — IN PROGRESS

## Domain Expertise

None

## Cross-Cutting Concern: LOIS Documentation

Every phase must advance LOIS integration readiness (per serene-prancing-platypus.md):

- **Phase 1**: Add LOIS compatibility comments to data types and TriggerEvent
- **Phase 2**: Document integration points with `// LOIS INTEGRATION POINT` markers
- **Phase 3**: Note data format differences from LOIS conventions
- **Phase 4**: Consolidate into LOIS_INTEGRATION.md guide

This is a **quality gate** — phases don't ship until LOIS documentation is updated.

## Phases

**Phase Numbering:**

- Integer phases (1, 2, 3): Planned milestone work
- Decimal phases (2.1, 2.2): Urgent insertions (marked with INSERTED)

<details>
<summary>v1.0 Autopilot Frontend Integration (Phases 1-4) — SHIPPED 2026-01-08</summary>

- [x] **Phase 1: Backend Protocol** - Define message types, wire autopilot backend to serve all CLI data via WebSocket
- [x] **Phase 2: Frontend Connection** - Add Vite proxy, connect widget to backend, display live data
- [x] **Phase 3: Controls & P&L** - Implement commands, integrate NATS for real-time P&L calculation
- [x] **Phase 4: Auto-Startup (Stretch)** - Auto-start autopilot backend alongside frontend dev server

</details>

<details>
<summary>v1.1 Autopilot Unit Tests (Phase 5) — SHIPPED 2026-01-08</summary>

- [x] **Phase 5: Unit Tests** - P&L calculation, store slice, and WebSocket message parsing tests (18 tests)

</details>

<details>
<summary>v1.2 Widget UX Polish (Phases 6-8) — SHIPPED 2026-01-08</summary>

- [x] **Phase 6: Real-Time Activity Indicators** - Countdown timer, live timestamps, token analysis counter
- [x] **Phase 7: Layout Reorganization** - Section reorganization, visual hierarchy, spacing improvements
- [x] **Phase 8: Collapsible Sections & Polish** - Expand/collapse for widget areas, final visual refinements

</details>

<details>
<summary>v1.3 Get Shit Working (Phases 9-11) — SHIPPED 2026-01-08</summary>

**Milestone Goal:** Fix data flow issues and align widget design with app design system

**Issues Resolved:**

1. Token stats always 0.0% - Fixed with NATS subscription for token mints
2. P&L not updating - Fixed with frontend calculation from position data
3. Market status SOL +0.00% - Fixed with SOL/USDC NATS subscription
4. Design inconsistencies - Fixed with design system color alignment

- [x] **Phase 9: Data Flow Investigation** - Architecture decision for hybrid NATS approach
- [x] **Phase 10: Data Flow Fixes** - Implemented hybrid data enrichment
- [x] **Phase 11: Design System Alignment** - Widget colors aligned with app theme

</details>

<details open>
<summary>v1.4 Widget Polish & Data Fixes (Phases 12-14) — IN PROGRESS</summary>

**Milestone Goal:** Fix data flow issues, improve layout clarity, add trading controls

**Issues to Resolve:**

1. Token price changes showing 0.00% (NATS data not arriving)
2. Position cards showing "Loading" (market data subscription issue)
3. Layout clarity (header elements, activity row numbers unclear)
4. Token list layout (currently vertical, want three columns)
5. Missing "Close All Trades" button
6. Dollar amounts not formatted consistently

- [x] **Phase 12: Data Flow Debugging** - Fix NATS market data for tokens and positions
- [x] **Phase 13: Layout & Clarity** - Three-column tokens, reorder sections, clarify labels
- [ ] **Phase 14: Controls & Formatting** - Close all button, 2 decimal places, header polish
- [ ] **Phase 15: Discovery API Integration** - Replace slow local autopilot backend with fast Discovery API endpoints

</details>

## Progress

**Execution Order:**
Phases execute in numeric order: 1 → 2 → ... → 11 → 12 → 13 → 14 → 15

| Phase                            | Milestone | Plans Complete | Status   | Completed  |
| -------------------------------- | --------- | -------------- | -------- | ---------- |
| 1. Backend Protocol              | v1.0      | 1/1            | Complete | 2026-01-08 |
| 2. Frontend Connection           | v1.0      | 1/1            | Complete | 2026-01-08 |
| 3. Controls & P&L                | v1.0      | 1/1            | Complete | 2026-01-08 |
| 4. Auto-Startup (Stretch)        | v1.0      | 1/1            | Complete | 2026-01-08 |
| 5. Unit Tests                    | v1.1      | 1/1            | Complete | 2026-01-08 |
| 6. Real-Time Activity Indicators | v1.2      | 1/1            | Complete | 2026-01-08 |
| 7. Layout Reorganization         | v1.2      | 1/1            | Complete | 2026-01-08 |
| 8. Collapsible Sections & Polish | v1.2      | 1/1            | Complete | 2026-01-08 |
| 9. Data Flow Investigation       | v1.3      | 1/1            | Complete | 2026-01-08 |
| 10. Data Flow Fixes              | v1.3      | 1/1            | Complete | 2026-01-08 |
| 11. Design System Alignment      | v1.3      | 1/1            | Complete | 2026-01-08 |
| 12. Data Flow Debugging          | v1.4      | 1/1            | Complete | 2026-01-08 |
| 13. Layout & Clarity             | v1.4      | 1/1            | Complete | 2026-01-09 |
| 14. Controls & Formatting        | v1.4      | 0/1            | Pending  |            |
| 15. Discovery API Integration    | v1.4      | 0/1            | Pending  |            |

## Future Work

### CLI NATS Integration (Deferred)

**Problem:** CLI currently queries ClickHouse for token screening data while frontend already receives the same data via NATS WebSocket streams. This creates duplicate data pipeline costs.

**Options for future milestone:**

1. **CLI connects to NATS** - CLI subscribes to NATS instead of querying ClickHouse
2. **Frontend signal consolidation** - Move strategy rules to frontend TypeScript

**Rationale for deferral:** Keep v1.3 scope focused on fixing display issues. Data pipeline optimization can be addressed once display functionality is complete.

**Logged:** 2026-01-08 during Phase 9 architecture decision
