# Roadmap: Autopilot Frontend Integration

## Overview

Bring the token-analysis-autopilot CLI's paper trading capabilities into the web-terminal dashboard widget. Starting with backend WebSocket protocol, then frontend connection, then controls and live P&L. Stretch goal: auto-start backend with dev server.

## Milestones

- [v1.0 Autopilot Frontend Integration](milestones/v1.0-ROADMAP.md) (Phases 1-4) â€” SHIPPED 2026-01-08
- [v1.1 Autopilot Unit Tests](milestones/v1.1-ROADMAP.md) (Phase 5) â€” SHIPPED 2026-01-08
- [v1.2 Widget UX Polish](milestones/v1.2-ROADMAP.md) (Phases 6-8) â€” SHIPPED 2026-01-08
- [v1.3 Get Shit Working](milestones/v1.3-ROADMAP.md) (Phases 9-11) â€” SHIPPED 2026-01-08
- [v1.4 Widget Polish & Data Fixes](milestones/v1.4-ROADMAP.md) (Phases 12-17) â€” SHIPPED 2026-01-09
- [v1.5 AAT Fixes](milestones/v1.5-ROADMAP.md) (Phases 18, 22, 20, 21) â€” SHIPPED 2026-01-09
- ðŸš§ **v2.0 Backend Integration** - Phases 23-26 (in progress)

## Domain Expertise

None

## Cross-Cutting Concern: LOIS Documentation

Every phase must advance LOIS integration readiness (per serene-prancing-platypus.md):

- **Phase 1**: Add LOIS compatibility comments to data types and TriggerEvent
- **Phase 2**: Document integration points with `// LOIS INTEGRATION POINT` markers
- **Phase 3**: Note data format differences from LOIS conventions
- **Phase 4**: Consolidate into LOIS_INTEGRATION.md guide

This is a **quality gate** â€” phases don't ship until LOIS documentation is updated.

## Phases

**Phase Numbering:**

- Integer phases (1, 2, 3): Planned milestone work
- Decimal phases (2.1, 2.2): Urgent insertions (marked with INSERTED)

<details>
<summary>v1.0 Autopilot Frontend Integration (Phases 1-4) â€” SHIPPED 2026-01-08</summary>

- [x] **Phase 1: Backend Protocol** - Define message types, wire autopilot backend to serve all CLI data via WebSocket
- [x] **Phase 2: Frontend Connection** - Add Vite proxy, connect widget to backend, display live data
- [x] **Phase 3: Controls & P&L** - Implement commands, integrate NATS for real-time P&L calculation
- [x] **Phase 4: Auto-Startup (Stretch)** - Auto-start autopilot backend alongside frontend dev server

</details>

<details>
<summary>v1.1 Autopilot Unit Tests (Phase 5) â€” SHIPPED 2026-01-08</summary>

- [x] **Phase 5: Unit Tests** - P&L calculation, store slice, and WebSocket message parsing tests (18 tests)

</details>

<details>
<summary>v1.2 Widget UX Polish (Phases 6-8) â€” SHIPPED 2026-01-08</summary>

- [x] **Phase 6: Real-Time Activity Indicators** - Countdown timer, live timestamps, token analysis counter
- [x] **Phase 7: Layout Reorganization** - Section reorganization, visual hierarchy, spacing improvements
- [x] **Phase 8: Collapsible Sections & Polish** - Expand/collapse for widget areas, final visual refinements

</details>

<details>
<summary>v1.3 Get Shit Working (Phases 9-11) â€” SHIPPED 2026-01-08</summary>

**Milestone Goal:** Fix data flow issues and align widget design with app design system

**Issues Resolved:**

1. Token stats always 0.0% - Fixed with NATS subscription for token mints
2. P&L not updating - Fixed with frontend calculation from position data
3. Market status SOL +0.00% - Fixed with SOL/USDC NATS subscription
4. Design inconsistencies - Fixed with design system color alignment

- [x] **Phase 9: Data Flow Investigation** - Architecture decision for hybrid NATS approach
- [x] **Phase 10: Data Flow Fixes** - Implemented hybrid data enrichment
- [x] **Phase 11: Design System Alignment** - Widget colors aligned with app theme

</details>

<details>
<summary>v1.4 Widget Polish & Data Fixes (Phases 12-17) â€” SHIPPED 2026-01-09</summary>

- [x] **Phase 12: Data Flow Debugging** - Fix NATS market data for tokens and positions
- [x] **Phase 13: Layout & Clarity** - Three-column tokens, reorder sections, clarify labels
- [x] **Phase 14: Controls & Formatting** - Draggable SettingsPanel, header controls, renamed to Screener
- [x] **Phase 15: Discovery API Integration** - Frontend uses Discovery API/WebSocket for whale moves and trending
- [x] **Phase 16: User Watchlist Integration** - Replace CLI-derived watchlist with user's watchlist
- [x] **Phase 17: Screener Signal Indicators** - Confluence-based background colors on token rows

See [v1.4-ROADMAP.md](milestones/v1.4-ROADMAP.md) for full details.

</details>

<details>
<summary>v1.5 AAT Fixes (Phases 18, 22, 20, 21) â€” SHIPPED 2026-01-09</summary>

**Milestone Goal:** Fix critical bugs (token names, Sell All, P&L), watchlist-style screener with volume trends, rename to AAT

**Execution Order:** 18 â†’ 22 â†’ 20 â†’ 21

#### Phase 18: Data Fixes â€” COMPLETE

**Goal**: Fix watchlist token names (showing blank) + show market cap instead of tiny prices
**Depends on**: Phase 17
**Research**: Unlikely (internal patterns)
**Plans**: 1

Plans:

- [x] 18-01: Fix blank symbols and display market cap

#### Phase 20: Controls & Accuracy â€” COMPLETE

**Goal**: Fix Sell All button (doesn't close positions) + fix P&L calculations
**Depends on**: Phase 22
**Research**: Unlikely (internal wiring)
**Plans**: 1

Plans:

- [x] 20-01: Frontend Close Controls

#### Phase 21: AAT Naming â€” COMPLETE

**Goal**: Rename widget from "Autopilot" to "AAT Autonomous Anomaly Terminal"
**Depends on**: Phase 20
**Research**: Unlikely (string updates)
**Plans**: 1

Plans:

- [x] 21-01: AAT branding string updates

#### Phase 22: Watchlist-Style Screener with Volume Trends â€” COMPLETE

**Goal**: Adopt production Watchlist widget layout for three screener columns. Replace liquidity/volume columns with mcap, price, and volume trend score. Volume trend = 15m vs 6h ratio, buy/sell volume momentum analysis. Background scoring weighted by conditions, mcap, liquidity. Match Watchlist styling (headers, text format, sorting, linked items) as compactly as possible while maintaining brand font sizes.
**Depends on**: Phase 18
**Research**: Likely (Watchlist widget patterns, volume data sources)
**Plans**: 3

Plans:

- [x] 22-01: Data Source Consolidation
- [x] 22-02: Watchlist-Style Table Layout
- [x] 22-03: Volume Trend Scoring (Vz indicator)

</details>

### âœ… v2.0 Backend Integration â€” SHIPPED 2026-01-09

**Milestone Goal:** Reverse WebSocket architecture â€” frontend becomes client, sends data feeds, receives events from CLI backend

#### Phase 23: WebSocket Client Refactor â€” COMPLETE

**Goal**: Add data feed protocol types and sendFeed method for v2.0 architecture
**Depends on**: v1.5 complete
**Research**: None needed
**Plans**: 1

Plans:

- [x] 23-01: Add Data Feed Protocol

#### Phase 24: Data Feed Implementation â€” COMPLETE

**Goal**: Forward market_data, ohlcv, trade, cvd from NATS/Discovery to backend
**Depends on**: Phase 23
**Research**: Unlikely (existing data sources)
**Plans**: 1

Plans:

- [x] 24-01: Data Feed Pipeline

#### Phase 25: Command & Event Protocol â€” COMPLETE

**Goal**: Full command suite + event handlers extracted for testability
**Depends on**: Phase 24
**Research**: Unlikely (established patterns)
**Plans**: 1

Plans:

- [x] 25-01: Extract Event Parser

#### Phase 26: Integration Testing â€” COMPLETE

**Goal**: End-to-end validation with CLI backend
**Depends on**: Phase 25
**Research**: Unlikely (testing patterns)
**Plans**: 1

Plans:

- [x] 26-01: Feed Adapter Testing

## Progress

**Execution Order:**
Phases execute: 1-18 â†’ 22 â†’ 20 â†’ 21 â†’ 23 â†’ 24 â†’ 25 â†’ 26

| Phase                            | Milestone | Plans Complete | Status   | Completed  |
| -------------------------------- | --------- | -------------- | -------- | ---------- |
| 1. Backend Protocol              | v1.0      | 1/1            | Complete | 2026-01-08 |
| 2. Frontend Connection           | v1.0      | 1/1            | Complete | 2026-01-08 |
| 3. Controls & P&L                | v1.0      | 1/1            | Complete | 2026-01-08 |
| 4. Auto-Startup (Stretch)        | v1.0      | 1/1            | Complete | 2026-01-08 |
| 5. Unit Tests                    | v1.1      | 1/1            | Complete | 2026-01-08 |
| 6. Real-Time Activity Indicators | v1.2      | 1/1            | Complete | 2026-01-08 |
| 7. Layout Reorganization         | v1.2      | 1/1            | Complete | 2026-01-08 |
| 8. Collapsible Sections & Polish | v1.2      | 1/1            | Complete | 2026-01-08 |
| 9. Data Flow Investigation       | v1.3      | 1/1            | Complete | 2026-01-08 |
| 10. Data Flow Fixes              | v1.3      | 1/1            | Complete | 2026-01-08 |
| 11. Design System Alignment      | v1.3      | 1/1            | Complete | 2026-01-08 |
| 12. Data Flow Debugging          | v1.4      | 1/1            | Complete | 2026-01-08 |
| 13. Layout & Clarity             | v1.4      | 1/1            | Complete | 2026-01-09 |
| 14. Controls & Formatting        | v1.4      | 1/1            | Complete | 2026-01-09 |
| 15. Discovery API Integration    | v1.4      | 1/1            | Complete | 2026-01-09 |
| 16. User Watchlist Integration   | v1.4      | 1/1            | Complete | 2026-01-09 |
| 17. Screener Signal Indicators   | v1.4      | 1/1            | Complete | 2026-01-09 |
| 18. Data Fixes                   | v1.5      | 1/1            | Complete | 2026-01-09 |
| 22. Watchlist-Style Screener     | v1.5      | 3/3            | Complete | 2026-01-09 |
| 20. Controls & Accuracy          | v1.5      | 1/1            | Complete | 2026-01-09 |
| 21. AAT Naming                   | v1.5      | 1/1            | Complete | 2026-01-09 |
| 23. WebSocket Client Refactor    | v2.0      | 1/1            | Complete | 2026-01-09 |
| 24. Data Feed Implementation     | v2.0      | 1/1            | Complete | 2026-01-09 |
| 25. Command & Event Protocol     | v2.0      | 1/1            | Complete | 2026-01-09 |
| 26. Integration Testing          | v2.0      | 1/1            | Complete | 2026-01-09 |

## Future Work

### Backend Optimization (v2.1 Candidate)

**Goal:** Optimize autopilot CLI backend for faster startup and better data pipeline efficiency.

**Phases (in priority order):**

1. **Discovery WebSocket Integration** - Replace slow API polling for trending/whales with Discovery WebSocket subscription (same as frontend). Currently takes several seconds at startup; should be instant.
2. **CLI NATS Integration** - CLI subscribes to NATS for token data instead of querying ClickHouse (see below)
3. **Frontend Signal Consolidation** - Move strategy rules to frontend TypeScript (optional)

**Logged:** 2026-01-09 during Phase 15 Discovery API Integration

---

### CLI NATS Integration (Deferred)

**Problem:** CLI currently queries ClickHouse for token screening data while frontend already receives the same data via NATS WebSocket streams. This creates duplicate data pipeline costs.

**Options for future milestone:**

1. **CLI connects to NATS** - CLI subscribes to NATS instead of querying ClickHouse
2. **Frontend signal consolidation** - Move strategy rules to frontend TypeScript

**Rationale for deferral:** Keep v1.3 scope focused on fixing display issues. Data pipeline optimization can be addressed once display functionality is complete.

**Logged:** 2026-01-08 during Phase 9 architecture decision
