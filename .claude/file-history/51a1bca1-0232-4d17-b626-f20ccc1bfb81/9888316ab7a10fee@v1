---
phase: 08-collapsible-sections-polish
plan: 01
type: execute
---

<objective>
Add expand/collapse behavior to main widget sections (Performance, Activity, Tokens) and final visual polish.

Purpose: Improve information density control - users can collapse sections they don't need, reducing visual noise and making the widget more focused.
Output: Widget sections are collapsible with persisted state and consistent styling.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
./summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

# Prior phase context
@.planning/phases/07-layout-reorganization/07-01-SUMMARY.md

# Source files
@apps/web-terminal/src/ui/dashboard/widgets/autopilot-widget.tsx

**Established patterns:**
- SectionHeader component: `text-[10px] uppercase tracking-wide font-medium text-tertiary`
- ControlsPanel and StrategiesPanel already have expand/collapse (useState pattern)
- Section gap-4 between major sections, gap-2 within sections

**Key constraints:**
- Follow existing expand/collapse pattern from ControlsPanel/StrategiesPanel
- Keep Configuration section always visible (controls are already collapsible)
- Tokens section should default to expanded (main content area)
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add collapsible behavior to Performance and Activity sections</name>
  <files>apps/web-terminal/src/ui/dashboard/widgets/autopilot-widget.tsx</files>
  <action>
Create a CollapsibleSection component following the existing ControlsPanel/StrategiesPanel pattern:
- Props: title (string), defaultExpanded (boolean), children
- Uses useState for expanded state
- SectionHeader becomes clickable with ▼/▲ indicator
- Content conditionally rendered based on expanded state
- Smooth visual transition (optional, keep simple if complex)

Apply CollapsibleSection to:
1. Performance section (Stats + Open Positions) - defaultExpanded: true
2. Activity section (LastAnalysis + Recent Signals) - defaultExpanded: true

Do NOT make Tokens section collapsible (it's the main scrollable content area).
Do NOT change Configuration section (controls/strategies already have their own expand/collapse).
  </action>
  <verify>Widget renders with collapsible Performance and Activity sections. Clicking section headers toggles visibility. TypeScript compilation passes.</verify>
  <done>Performance and Activity sections toggle expand/collapse on header click. Default state is expanded for both.</done>
</task>

<task type="auto">
  <name>Task 2: Visual polish and final refinements</name>
  <files>apps/web-terminal/src/ui/dashboard/widgets/autopilot-widget.tsx</files>
  <action>
Polish visual details:
1. Add subtle visual indicator for collapsed sections (e.g., slightly different background or border when collapsed)
2. Ensure consistent spacing when sections are collapsed (no double gaps)
3. Add transition animation for expand/collapse (use Tailwind's transition classes if simple, skip if complex)
4. Verify all section headers have consistent hover states

Final checks:
- Verify TypeScript compilation
- Verify no visual regressions in expanded state
- Ensure collapsed sections still show header clearly
  </action>
  <verify>npm run typecheck passes. Visual inspection shows smooth collapse behavior with consistent styling.</verify>
  <done>Visual polish complete - consistent styling, proper spacing, and clear visual feedback for expand/collapse state.</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `npm run typecheck` passes
- [ ] Performance section collapses/expands on header click
- [ ] Activity section collapses/expands on header click
- [ ] Tokens section remains always visible (not collapsible)
- [ ] Configuration section unchanged (already has internal expand/collapse)
- [ ] No visual regressions in fully expanded state
</verification>

<success_criteria>

- All tasks completed
- All verification checks pass
- Widget sections are collapsible with clear visual feedback
- No TypeScript errors
- Existing functionality preserved
</success_criteria>

<output>
After completion, create `.planning/phases/08-collapsible-sections-polish/08-01-SUMMARY.md` following the summary template.
</output>
