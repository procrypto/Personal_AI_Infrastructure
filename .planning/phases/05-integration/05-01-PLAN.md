---
phase: 05-integration
plan: 01
type: execute
---

<objective>
Integrate advance-work.md into execute-phase.md's offer_next step.

Purpose: Replace inline scenario handling in execute-phase.md with centralized advance-work.md workflow, enabling auto-advance functionality.
Output: Modified execute-phase.md that delegates advancement logic to advance-work.md
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

# Prior phase summaries (dependency chain):
@.planning/phases/03-advance-logic/03-01-SUMMARY.md
@.planning/phases/03-advance-logic/03-02-SUMMARY.md
@.planning/phases/04-command-interface/04-01-SUMMARY.md

# Key files:
@~/.claude/get-shit-done/workflows/execute-phase.md (lines 1568-1713 - offer_next step)
@~/.claude/get-shit-done/workflows/advance-work.md (integration target)

**Tech stack available:** config-driven behavior, scenario-based-routing, mode-behavior-matrix
**Established patterns:** 7-step-workflow-process from create-phase-summary.md

**Constraining decisions:**
- Phase 3: advance-work.md is single source of truth for advancement
- Phase 3: Three scenarios: same_phase, phase_complete, milestone_complete
- Phase 3: milestone_complete always prompts regardless of mode

**Integration contract (from advance-work.md):**
- Entry: execute-phase.md offer_next step calls advance-work.md
- Parameters: current_plan_path (path to just-completed plan)
- Returns: Action to take (execute/prompt/transition/milestone_complete)
</context>

<tasks>

<task type="auto">
  <name>Task 1: Replace offer_next inline logic with advance-work.md invocation</name>
  <files>~/.claude/get-shit-done/workflows/execute-phase.md</files>
  <action>
Replace the entire offer_next step (lines 1568-1713) with a streamlined version that:

1. Sets up context: PLAN_PATH from the just-executed plan
2. Invokes advance-work.md workflow with: current_plan_path="$PLAN_PATH"
3. The advance-work.md workflow handles all scenario detection and routing

The new offer_next step should be much shorter since all logic is delegated:
```xml
<step name="offer_next">
**Invoke advancement workflow:**

The advance-work.md workflow handles scenario detection and routing:
- Detects: same_phase | phase_complete | milestone_complete
- Respects: config.json auto_advance settings and mode
- Handles: Auto-execute, prompts, transitions, milestone completion

**Invocation:**
Pass the just-completed plan path to advance-work.md:
```
current_plan_path="$PLAN_PATH"
â†’ ~/.claude/get-shit-done/workflows/advance-work.md
```

advance-work.md will:
1. Load context (STATE.md, config.json, ROADMAP.md)
2. Detect scenario from plan/summary counts
3. Route to appropriate handler
4. Either auto-execute next plan (yolo + same_phase) or prompt user

See advance-work.md for complete scenario handling logic.
</step>
```

**What to avoid:**
- Do NOT duplicate scenario detection logic (advance-work.md owns this)
- Do NOT handle mode-specific behavior (advance-work.md owns this)
- Do NOT change any steps before offer_next
  </action>
  <verify>Read the modified offer_next step in execute-phase.md. Should be ~30 lines delegating to advance-work.md, not ~145 lines of inline handling.</verify>
  <done>offer_next step is simplified to invoke advance-work.md; all scenario logic removed from execute-phase.md</done>
</task>

<task type="auto">
  <name>Task 2: Update integration documentation in advance-work.md</name>
  <files>~/.claude/get-shit-done/workflows/advance-work.md</files>
  <action>
Update the integration_points section in advance-work.md to reflect that integration is now complete:

1. Change "Entry points" from future tense to present tense
2. Update flow diagram if needed to show actual implementation
3. Add note that execute-phase.md integration was completed in Phase 5

Keep the invocation section accurate (parameters, prerequisites).

**What to avoid:**
- Do NOT change any handler logic (same_phase, phase_complete, milestone_complete)
- Do NOT modify scenario detection
  </action>
  <verify>Read the updated integration_points section. Should accurately describe current integration state.</verify>
  <done>advance-work.md integration_points section reflects completed integration with execute-phase.md</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] execute-phase.md offer_next step delegates to advance-work.md
- [ ] No inline scenario handling remains in execute-phase.md offer_next
- [ ] advance-work.md integration_points is accurate
- [ ] No syntax errors in either file (valid XML/markdown structure)
</verification>

<success_criteria>

- Both tasks completed
- execute-phase.md offer_next is ~30 lines (delegation), not ~145 lines (inline handling)
- advance-work.md documentation matches implementation
- Ready for backward compatibility testing in 05-02
</success_criteria>

<output>
After completion, create `.planning/phases/05-integration/05-01-SUMMARY.md`:

# Phase 05 Plan 01: Integrate advance-work.md Summary

**[Substantive one-liner about what shipped]**

## Accomplishments

- [Key outcome 1]
- [Key outcome 2]

## Files Created/Modified

- `~/.claude/get-shit-done/workflows/execute-phase.md` - offer_next step simplified
- `~/.claude/get-shit-done/workflows/advance-work.md` - Integration docs updated

## Decisions Made

[Any decisions, or "None"]

## Issues Encountered

[Problems and resolutions, or "None"]

## Next Step

Ready for 05-02-PLAN.md (backward compatibility verification)
</output>
